<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Cálculo discreto | Métodos de matemáticas aplicadas</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Cálculo discreto | Métodos de matemáticas aplicadas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Cálculo discreto | Métodos de matemáticas aplicadas" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Héctor Andrés Chang-Lara" />


<meta name="date" content="2023-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="entramados.html"/>
<link rel="next" href="dinámica.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Métodos de matemáticas aplicadas</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="part"><span><b>Modelos discretos</b></span></li>
<li class="chapter" data-level="1" data-path="entramados.html"><a href="entramados.html"><i class="fa fa-check"></i><b>1</b> Entramados</a></li>
<li class="chapter" data-level="2" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html"><i class="fa fa-check"></i><b>2</b> Cálculo discreto</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#gradiente"><i class="fa fa-check"></i><b>2.1</b> Gradiente</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#ley-de-ciclos"><i class="fa fa-check"></i><b>2.1.1</b> Ley de ciclos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#divergencia"><i class="fa fa-check"></i><b>2.2</b> Divergencia</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#fórmula-de-la-divergencia"><i class="fa fa-check"></i><b>2.2.1</b> Fórmula de la divergencia</a></li>
<li class="chapter" data-level="2.2.2" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#lema-de-poincaré-para-la-divergencia"><i class="fa fa-check"></i><b>2.2.2</b> Lema de Poincaré para la divergencia</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#integración-por-partes"><i class="fa fa-check"></i><b>2.3</b> Integración por partes</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#descomposición-de-helmholtz"><i class="fa fa-check"></i><b>2.3.1</b> Descomposición de Helmholtz</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#laplaciano"><i class="fa fa-check"></i><b>2.4</b> Laplaciano</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dinámica.html"><a href="dinámica.html"><i class="fa fa-check"></i><b>3</b> Dinámica</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dinámica.html"><a href="dinámica.html#transporte"><i class="fa fa-check"></i><b>3.1</b> Transporte</a></li>
<li class="chapter" data-level="3.2" data-path="dinámica.html"><a href="dinámica.html#difusión"><i class="fa fa-check"></i><b>3.2</b> Difusión</a></li>
<li class="chapter" data-level="3.3" data-path="dinámica.html"><a href="dinámica.html#oscilación"><i class="fa fa-check"></i><b>3.3</b> Oscilación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html"><i class="fa fa-check"></i><b>4</b> Implementación del entramado</a>
<ul>
<li class="chapter" data-level="4.1" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#librerías-y-datos"><i class="fa fa-check"></i><b>4.1</b> Librerías y datos</a></li>
<li class="chapter" data-level="4.2" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#ecuación-diferencial"><i class="fa fa-check"></i><b>4.2</b> Ecuación diferencial</a></li>
<li class="chapter" data-level="4.3" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#integración-y-graficación"><i class="fa fa-check"></i><b>4.3</b> Integración y graficación</a></li>
<li class="chapter" data-level="4.4" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#incremento-en-la-rigidez-de-los-resortes"><i class="fa fa-check"></i><b>4.4</b> Incremento en la rigidez de los resortes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html"><i class="fa fa-check"></i><b>5</b> Espectro del Laplaciano</a>
<ul>
<li class="chapter" data-level="5.1" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#problema-elíptico"><i class="fa fa-check"></i><b>5.1</b> Problema elíptico</a></li>
<li class="chapter" data-level="5.2" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#problema-parabólico"><i class="fa fa-check"></i><b>5.2</b> Problema parabólico</a></li>
<li class="chapter" data-level="5.3" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#problema-hiperbólico"><i class="fa fa-check"></i><b>5.3</b> Problema hiperbólico</a></li>
<li class="chapter" data-level="5.4" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#nerd-sniping"><i class="fa fa-check"></i><b>5.4</b> Nerd sniping</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html"><i class="fa fa-check"></i><b>6</b> El problema de Dirichlet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#ley-de-conservación"><i class="fa fa-check"></i><b>6.1</b> Ley de conservación</a></li>
<li class="chapter" data-level="6.2" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#existencia-y-unicidad-de-soluciones"><i class="fa fa-check"></i><b>6.2</b> Existencia y unicidad de soluciones</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#principio-del-mínimo"><i class="fa fa-check"></i><b>6.2.1</b> Principio del mínimo</a></li>
<li class="chapter" data-level="6.2.2" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#método-de-balayage"><i class="fa fa-check"></i><b>6.2.2</b> Método de Balayage</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#fórmulas-de-representación"><i class="fa fa-check"></i><b>6.3</b> Fórmulas de representación</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#la-función-de-green"><i class="fa fa-check"></i><b>6.3.1</b> La función de Green</a></li>
<li class="chapter" data-level="6.3.2" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#el-núcleo-de-poisson"><i class="fa fa-check"></i><b>6.3.2</b> El núcleo de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#caminatas-aleatorias"><i class="fa fa-check"></i><b>6.4</b> Caminatas Aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimización.html"><a href="optimización.html"><i class="fa fa-check"></i><b>7</b> Optimización</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimización.html"><a href="optimización.html#métrica-de-sobolev"><i class="fa fa-check"></i><b>7.1</b> Métrica de Sobolev</a></li>
<li class="chapter" data-level="7.2" data-path="optimización.html"><a href="optimización.html#capacitancia"><i class="fa fa-check"></i><b>7.2</b> Capacitancia</a></li>
<li class="chapter" data-level="7.3" data-path="optimización.html"><a href="optimización.html#métrica-dual"><i class="fa fa-check"></i><b>7.3</b> Métrica dual</a></li>
<li class="chapter" data-level="7.4" data-path="optimización.html"><a href="optimización.html#cociente-de-rayleigh"><i class="fa fa-check"></i><b>7.4</b> Cociente de Rayleigh</a></li>
</ul></li>
<li class="part"><span><b>Transporte y leyes de conservación</b></span></li>
<li class="chapter" data-level="8" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html"><i class="fa fa-check"></i><b>8</b> Cantidades conservadas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-homogéneos"><i class="fa fa-check"></i><b>8.1</b> Problemas homogéneos</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#leyes-de-conservación-en-mecánica"><i class="fa fa-check"></i><b>8.1.1</b> Leyes de conservación en mecánica</a></li>
<li class="chapter" data-level="8.1.2" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#ecuaciones-exactas-y-conjugados-armónicos"><i class="fa fa-check"></i><b>8.1.2</b> Ecuaciones exactas y conjugados armónicos</a></li>
<li class="chapter" data-level="8.1.3" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#el-teorema-de-frobenius"><i class="fa fa-check"></i><b>8.1.3</b> El teorema de Frobenius</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-no-homogéneos"><i class="fa fa-check"></i><b>8.2</b> Problemas no-homogéneos</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#sistemas-lineales-no-homogéneos"><i class="fa fa-check"></i><b>8.2.1</b> Sistemas lineales no homogéneos</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-semi-lineales"><i class="fa fa-check"></i><b>8.3</b> Problemas semi-lineales</a></li>
<li class="chapter" data-level="8.4" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-cuasi-lineales"><i class="fa fa-check"></i><b>8.4</b> Problemas cuasi-lineales</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html"><i class="fa fa-check"></i><b>9</b> Leyes de conservación</a>
<ul>
<li class="chapter" data-level="9.1" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#teorema-de-transporte"><i class="fa fa-check"></i><b>9.1</b> Teorema de transporte</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#ecuación-de-tráfico"><i class="fa fa-check"></i><b>9.1.1</b> Ecuación de tráfico</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#reacción-y-difusión"><i class="fa fa-check"></i><b>9.2</b> Reacción y difusión</a></li>
<li class="chapter" data-level="9.3" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#mecánica-de-medios-continuos"><i class="fa fa-check"></i><b>9.3</b> Mecánica de medios continuos</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#ecuación-de-liouville-y-conservación-de-masa"><i class="fa fa-check"></i><b>9.3.1</b> Ecuación de Liouville y conservación de masa</a></li>
<li class="chapter" data-level="9.3.2" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#conservación-del-momento"><i class="fa fa-check"></i><b>9.3.2</b> Conservación del momento</a></li>
<li class="chapter" data-level="9.3.3" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#teoría-cinética"><i class="fa fa-check"></i><b>9.3.3</b> Teoría cinética</a></li>
<li class="chapter" data-level="9.3.4" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#la-jerarquía-de-bogoliubov-born-green-kirkwood-yvon"><i class="fa fa-check"></i><b>9.3.4</b> La jerarquía de Bogoliubov-Born-Green-Kirkwood-Yvon</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#ecuaciones-de-maxwell"><i class="fa fa-check"></i><b>9.4</b> Ecuaciones de Maxwell</a></li>
<li class="chapter" data-level="9.5" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#distancia-de-wasserstein"><i class="fa fa-check"></i><b>9.5</b> Distancia de Wasserstein</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="soluciones-débiles.html"><a href="soluciones-débiles.html"><i class="fa fa-check"></i><b>10</b> Soluciones débiles</a></li>
<li class="chapter" data-level="11" data-path="modelos-estocásticos.html"><a href="modelos-estocásticos.html"><i class="fa fa-check"></i><b>11</b> Modelos estocásticos</a>
<ul>
<li class="chapter" data-level="11.1" data-path="modelos-estocásticos.html"><a href="modelos-estocásticos.html#el-movimiento-browniano"><i class="fa fa-check"></i><b>11.1</b> El movimiento Browniano</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="modelos-estocásticos.html"><a href="modelos-estocásticos.html#deducción-via-la-aproximación-de-stirling"><i class="fa fa-check"></i><b>11.1.1</b> Deducción via la aproximación de Stirling</a></li>
<li class="chapter" data-level="11.1.2" data-path="modelos-estocásticos.html"><a href="modelos-estocásticos.html#propiedades-del-movimiento-browniano"><i class="fa fa-check"></i><b>11.1.2</b> Propiedades del movimiento Browniano</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="modelos-estocásticos.html"><a href="modelos-estocásticos.html#martingalas"><i class="fa fa-check"></i><b>11.2</b> Martingalas</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="modelos-estocásticos.html"><a href="modelos-estocásticos.html#problemas-de-frontera-y-tiempo-de-salida"><i class="fa fa-check"></i><b>11.2.1</b> Problemas de frontera y tiempo de salida</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Métodos espectrales</b></span></li>
<li class="chapter" data-level="12" data-path="espectro.html"><a href="espectro.html"><i class="fa fa-check"></i><b>12</b> Espectro</a>
<ul>
<li class="chapter" data-level="12.1" data-path="espectro.html"><a href="espectro.html#resolución-de-distintos-problemas-usando-el-espectro"><i class="fa fa-check"></i><b>12.1</b> Resolución de distintos problemas usando el espectro</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="espectro.html"><a href="espectro.html#inversa"><i class="fa fa-check"></i><b>12.1.1</b> Inversa</a></li>
<li class="chapter" data-level="12.1.2" data-path="espectro.html"><a href="espectro.html#exponencial"><i class="fa fa-check"></i><b>12.1.2</b> Exponencial</a></li>
<li class="chapter" data-level="12.1.3" data-path="espectro.html"><a href="espectro.html#funciones-trigonométricas"><i class="fa fa-check"></i><b>12.1.3</b> Funciones trigonométricas</a></li>
<li class="chapter" data-level="12.1.4" data-path="espectro.html"><a href="espectro.html#cálculo-funcional"><i class="fa fa-check"></i><b>12.1.4</b> Cálculo funcional</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="espectro.html"><a href="espectro.html#casos-unidimensionales-para-el-laplaciano"><i class="fa fa-check"></i><b>12.2</b> Casos unidimensionales para el Laplaciano</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="espectro.html"><a href="espectro.html#segmento-con-dato-de-borde-cero"><i class="fa fa-check"></i><b>12.2.1</b> Segmento con dato de borde cero</a></li>
<li class="chapter" data-level="12.2.2" data-path="espectro.html"><a href="espectro.html#circunferencia-o-funciones-periódicas"><i class="fa fa-check"></i><b>12.2.2</b> Circunferencia o funciones periódicas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="series-de-fourier.html"><a href="series-de-fourier.html"><i class="fa fa-check"></i><b>13</b> Series de Fourier</a>
<ul>
<li class="chapter" data-level="13.1" data-path="series-de-fourier.html"><a href="series-de-fourier.html#propiedades-de-la-serie-de-fourier"><i class="fa fa-check"></i><b>13.1</b> Propiedades de la serie de Fourier</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="series-de-fourier.html"><a href="series-de-fourier.html#linealidad"><i class="fa fa-check"></i><b>13.1.1</b> Linealidad</a></li>
<li class="chapter" data-level="13.1.2" data-path="series-de-fourier.html"><a href="series-de-fourier.html#traslaciones"><i class="fa fa-check"></i><b>13.1.2</b> Traslaciones</a></li>
<li class="chapter" data-level="13.1.3" data-path="series-de-fourier.html"><a href="series-de-fourier.html#derivadas"><i class="fa fa-check"></i><b>13.1.3</b> Derivadas</a></li>
<li class="chapter" data-level="13.1.4" data-path="series-de-fourier.html"><a href="series-de-fourier.html#convoluciones"><i class="fa fa-check"></i><b>13.1.4</b> Convoluciones</a></li>
<li class="chapter" data-level="13.1.5" data-path="series-de-fourier.html"><a href="series-de-fourier.html#reescalamientos"><i class="fa fa-check"></i><b>13.1.5</b> Reescalamientos</a></li>
<li class="chapter" data-level="13.1.6" data-path="series-de-fourier.html"><a href="series-de-fourier.html#isometría"><i class="fa fa-check"></i><b>13.1.6</b> Isometría</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="método-de-separación-de-variables.html"><a href="método-de-separación-de-variables.html"><i class="fa fa-check"></i><b>14</b> Método de separación de variables</a>
<ul>
<li class="chapter" data-level="14.1" data-path="método-de-separación-de-variables.html"><a href="método-de-separación-de-variables.html#rectángulo-y-toro"><i class="fa fa-check"></i><b>14.1</b> Rectángulo y toro</a></li>
<li class="chapter" data-level="14.2" data-path="método-de-separación-de-variables.html"><a href="método-de-separación-de-variables.html#bola-bidimensional-y-las-funciones-de-bessel"><i class="fa fa-check"></i><b>14.2</b> Bola bidimensional y las funciones de Bessel</a></li>
<li class="chapter" data-level="14.3" data-path="método-de-separación-de-variables.html"><a href="método-de-separación-de-variables.html#esfera-bidimensional-y-los-esféricos-armónicos"><i class="fa fa-check"></i><b>14.3</b> Esfera bidimensional y los esféricos armónicos</a></li>
</ul></li>
<li class="part"><span><b>Fórmulas de representación</b></span></li>
<li class="chapter" data-level="15" data-path="problemas-unidimensionales.html"><a href="problemas-unidimensionales.html"><i class="fa fa-check"></i><b>15</b> Problemas unidimensionales</a></li>
<li class="chapter" data-level="16" data-path="solución-fundamental.html"><a href="solución-fundamental.html"><i class="fa fa-check"></i><b>16</b> Solución fundamental</a></li>
<li class="chapter" data-level="17" data-path="función-de-green-1.html"><a href="función-de-green-1.html"><i class="fa fa-check"></i><b>17</b> Función de Green</a></li>
<li class="chapter" data-level="18" data-path="núcleo-del-calor-1.html"><a href="núcleo-del-calor-1.html"><i class="fa fa-check"></i><b>18</b> Núcleo del calor</a></li>
<li class="chapter" data-level="19" data-path="fórmulas-de-representación-para-la-ecuación-de-onda.html"><a href="fórmulas-de-representación-para-la-ecuación-de-onda.html"><i class="fa fa-check"></i><b>19</b> Fórmulas de representación para la ecuación de onda</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Métodos de matemáticas aplicadas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cálculo-discreto" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Capítulo 2</span> Cálculo discreto<a href="cálculo-discreto.html#cálculo-discreto" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Una grafo dirigido <span class="math inline">\(G = (V,E)\)</span> consiste de un conjunto de vértices <span class="math inline">\(V\)</span>, también llamados nodos, y un conjunto de aristas <span class="math inline">\(E \subseteq V^2\)</span>, es decir pares ordenados de <span class="math inline">\(V\)</span>.</p>
<p>Dado <span class="math inline">\(e = (a,b)\in E\)</span>, denotamos por <span class="math inline">\(e_-=a\)</span> y <span class="math inline">\(e_+=b\)</span> los nodos de partida y llegada de <span class="math inline">\(e\)</span> respectivamente y decimos que <span class="math inline">\(e\)</span> está orientado del nodo de salida <span class="math inline">\(a\)</span> al nodo de llegada <span class="math inline">\(b\)</span>.</p>
<p>En general trabajaremos con grafos con aristas simples, es decir que a lo sumo existe una arista que conecta dos vértices en cualquier orientación. Sin embargo, cuando <span class="math inline">\(e=(a,b)\in E\)</span> podríamos hacer referencia a la arista <span class="math inline">\(-e:=(b,a)\)</span> como la arista <span class="math inline">\(e\)</span> pero con el sentido opuesto. Denotaremos <span class="math inline">\(-E = \{-e \in V^2:e\in E\}\)</span>.</p>
<p>Finalmente, podemos considerar también conjuntos de aristas no orientadas en cuyo caso decimos que el grafo es no dirigido.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-3" class="exercise"><strong>Ejercicio 2.1  </strong></span>Dibuja el grafo <span class="math inline">\(G=(V,E)\)</span> para
<span class="math display">\[
V = \{1,2,3,a,b,c\}, \qquad E = \{(1,a),(1,b),(1,c),(2,a),(2,b),(2,c),(3,a),(3,b),(3,c)\}.
\]</span></p>
</div>
<details>
<summary>
Solución
</summary>
<iframe src="https://www.geogebra.org/classic/xtjh7atb?embed" width="800" height="600" allowfullscreen style="border: 1px solid #e4e4e4;border-radius: 4px;" frameborder="0">
</iframe>
</details>
<hr />
<p>Las redes eléctricas son uno de los modelos más conocidos que se pueden formular en términos de grafos. Sobre el grafo podemos caracterizar por ejemplo el potencial o voltaje como una función <span class="math inline">\(u:V\to \mathbb R\)</span> y la corriente como una función <span class="math inline">\(i:E\to \mathbb R\)</span>. Siguiendo un poco la nomenclatura que sugiere este modelo, distinguimos dos tipos de funciones en <span class="math inline">\(G\)</span>:</p>
<ol style="list-style-type: decimal">
<li><strong>Potencial:</strong> Es una función sobre el conjunto de vértices <span class="math inline">\(u: V \to \mathbb R\)</span>.</li>
<li><strong>Flujo:</strong> Es una función sobre el conjunto de aristas <span class="math inline">\(f: E \to \mathbb R\)</span>.</li>
</ol>
<p>En algunos casos también podríamos considerar que dichas funciones tomen valores en <span class="math inline">\(\mathbb C\)</span>, <span class="math inline">\(\mathbb R^n\)</span> ó <span class="math inline">\(\mathbb C^n\)</span>.</p>
<p>También denominamos como flujos a funciones que están definidas en <span class="math inline">\(E\cup -E\)</span>, es decir que consideran ambas orientaciones de las aristas. Decimos que <span class="math inline">\(f:E\cup -E\to\mathbb R\)</span> es <strong>par</strong> cuando no depende de la orientación <span class="math inline">\(f(-e) = f(e)\)</span>, y decimos que <strong>impar</strong> si en cambio <span class="math inline">\(f(-e) = -f(e)\)</span>. Una función <span class="math inline">\(f:E\to\mathbb R\)</span> en un grafo no dirigido es equivalente a una función par en el mismo grafo y con cualquier orientación sobre las aristas.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-4" class="example"><strong>Ejemplo 2.1  </strong></span>En el modelo de <a href="entramados.html#entramados">entramados</a> en la sección anterior, el grafo no dirigido <span class="math inline">\(G=(V,E)\)</span> con <span class="math inline">\(V = \{0,1,2,3\}\)</span> y <span class="math inline">\(E=\{\{0,1\},\{1,2\},\{2,3\}\}\)</span> nos proporciona la información sobre cuales nodos están conectados entre si. Las posiciones de los nodos se caracterizan por <span class="math inline">\(q:V\to \mathbb R^2\)</span> y las longitudes de los enlaces están determinadas por <span class="math inline">\(\ell:E\to\mathbb R\)</span>.</p>
<p><img src="eje_1.png" style="width:70.0%" /></p>
<p>Para modelar las tensiones es conveniente considerar el grafo dirigido <span class="math inline">\(G=(V,E&#39;)\)</span> de alguna forma arbitraria, quizás <span class="math inline">\(E&#39;=\{(0,1),(1,2),(2,3)\}\)</span>. De esta forma contamos con la función par <span class="math inline">\(\lambda:E&#39;\cup-E&#39;\to\mathbb R\)</span> y la función impar <span class="math inline">\(T: E&#39;\cup-E&#39; \to \mathbb R^2\)</span> tales que
<span class="math display">\[
T(e) = \lambda(e)(q(e_+)-q(e_-))
\]</span>
es la tensión sobre el nodo <span class="math inline">\(e_-\)</span> a lo largo de <span class="math inline">\(e\)</span>. A su vez y gracias a la ley de acción y reacción, <span class="math inline">\(T(-e) = -T(e)\)</span> es la tensión sobre el nodo <span class="math inline">\(e_+\)</span> a lo largo de <span class="math inline">\(e\)</span> pero en la orientación opuesta, es decir <span class="math inline">\(-e\)</span>.</p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-5" class="example"><strong>Ejemplo 2.2  </strong></span>Un potencial <span class="math inline">\(u:V\to\mathbb R\)</span> sobre una red de resistencia genera una corriente <span class="math inline">\(i:E\to \mathbb R\)</span> que modelamos usando la ley de Ohm para una dada resistencia <span class="math inline">\(R:E\cup -E \to (0,\infty)\)</span> (función par). Esto quiere decir que la corriente <span class="math inline">\(i(e)\)</span> que atraviesa una arista <span class="math inline">\(e = (e_-,e_+)\)</span> es proporcional a la diferencia de los potenciales en los extremos de la arista
<span class="math display">\[
i(e) = \frac{u(e_+) - u(e_-)}{R(e)}, \qquad R(e) &gt;0: \text{ Resistencia.}
\]</span></p>
</div>
<hr />
<div id="gradiente" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Gradiente<a href="cálculo-discreto.html#gradiente" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tanto en la construcción de las tensiones <span class="math inline">\(T\)</span>, como en la de la corriente eléctrica <span class="math inline">\(i\)</span>, estamos considerando la variación de una dada función (las posiciones <span class="math inline">\(q\)</span> ó el potencial <span class="math inline">\(u\)</span>) a lo largo de una arista dada. Esto es una versión discreta de la derivada direccional. En este caso requerimos que el grafo sea orientado.</p>
<div class="definition">
<p><span id="def:unlabeled-div-6" class="definition"><strong>Definición 2.1  </strong></span>Dado potencial <span class="math inline">\(u:V\to\mathbb R\)</span> sobre un grafo dirigido <span class="math inline">\(G=(V,E)\)</span>, definimos el gradiente <span class="math inline">\(Du: E\cup -E \to \mathbb R\)</span> tal que
<span class="math display">\[
Du(e) = u(e_{+})-u(e_{-}).
\]</span></p>
</div>
<p>En particular, el gradiente es una función impar.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-7" class="exercise"><strong>Ejercicio 2.2  </strong></span>Calcula el gradiente de la función dada en los vértices del siguiente grafo</p>
<p><img src="gradeje.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
<img src="gradsol.png" style="width:70.0%" />
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-8" class="exercise"><strong>Ejercicio 2.3  </strong></span>Verifica que el gradiente satisface la identidad de Leibniz
<span class="math display">\[
D(u_1u_2) = u_1^+ Du_2 + u_2^-Du_1
\]</span>
donde <span class="math inline">\(u^\pm:E\to\mathbb R\)</span> se define a partir de <span class="math inline">\(u:V\to\mathbb R\)</span> como <span class="math inline">\(u^\pm(e) = u(e_\pm)\)</span>.</p>
</div>
<details>
<summary>
Solución
</summary>
<span class="math display">\[
  \begin{aligned}
  D(u_1u_2)(e) &amp;= u_1(e_+)u_2(e_+) - u_1(e_-)u_2(e_-),\\
               &amp;= u_1(e_+)u_2(e_+) - u_1(e_+)u_2(e_-) + u_1(e_+)u_2(e_-) - u_1(e_-)u_2(e_-),\\
               &amp;= u_1(e_+)(u_2(e_+)-u_2(e_-)) + u_2(e_-)(u_1(e_+)-u_1(e_-)),\\
               &amp;= u_1(e_+)Du_2(e) + u_2(e_-)Du_1(e),\\
               &amp;= (u_1^+Du_2 + u_2^-Du_1)(e).
  \end{aligned}
  \]</span>
</details>
<hr />
<div id="ley-de-ciclos" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Ley de ciclos<a href="cálculo-discreto.html#ley-de-ciclos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>No toda función (impar) <span class="math inline">\(f:E\cup -E \to \mathbb R\)</span> es necesariamente un gradiente. Una condición necesaria y suficiente es la <strong>ley de ciclos</strong>. Para poder enunciar esta ley es conveniente dar algunas definiciones previas para un dado grafo dirigido <span class="math inline">\(G=(V,E)\)</span>.</p>
<div class="definition">
<p><span id="def:unlabeled-div-9" class="definition"><strong>Definición 2.2  </strong></span>Un <strong>camino no orientado</strong> es una sucesión de vértices <span class="math inline">\(x_0,x_1, \dots, x_n \in V\)</span> tal que <span class="math inline">\((x_j,x_{j+1}) \in E\cup -E\)</span> para todo <span class="math inline">\(j\in\{0,1,\ldots,(n-1)\}\)</span>. Se dice que el camino es un <strong>ciclo</strong> si además <span class="math inline">\(x_n=x_0\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-10" class="definition"><strong>Definición 2.3  </strong></span>Una <strong>componente conexa</strong> de <span class="math inline">\(G\)</span> es un subconjunto <span class="math inline">\(V&#39;\subseteq V\)</span> tal que:</p>
<ul>
<li><p>Todos los vértices en <span class="math inline">\(V&#39;\)</span> están conectados entre si por algún camino.</p></li>
<li><p>Ningún vértice de <span class="math inline">\(V&#39;\)</span> está conectado con ningún vértice de <span class="math inline">\(V\setminus V&#39;\)</span>.</p></li>
</ul>
<p>Decimos que <span class="math inline">\(G\)</span> es <strong>conexo</strong> si tiene una única componente conexa.</p>
</div>
<div class="theorem">
<p><span id="thm:unlabeled-div-11" class="theorem"><strong>Teorema 2.1  (Ley de ciclos) </strong></span>Sea <span class="math inline">\(G=(V,E)\)</span> un grafo dirigido finito. Una función impar <span class="math inline">\(f:E\cup -E\to\mathbb R\)</span> es igual al gradiente de una función <span class="math inline">\(u:V\to \mathbb R\)</span> si y solo si para todo ciclo <span class="math inline">\(x_0,x_1, \dots, x_n=x_0\)</span> se tiene que
<span class="math display">\[
\sum_{j=0}^{n-1} f(x_j,x_{j+1}) = 0.
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-12" class="proof"><em>Demostración</em>. </span>Por un lado es fácil verificar la identidad para flujos gradientes usando la propiedad telescópica. Dado un ciclo <span class="math inline">\(x_0,x_1, \dots, x_n=x_0\)</span>
<span class="math display">\[
\sum_{j=0}^{n-1} Du(x_j,x_{j+1}) = \sum_{j=0}^{n-1} (u(x_{j+1})-u(x_j)) = u(x_n)-u(x_0)=0.
\]</span></p>
<p>Podemos construir <span class="math inline">\(u:V&#39;\to \mathbb R\)</span> sobre cada una de las componentes conexas de <span class="math inline">\(G\)</span> de la siguiente forma: Fijemos <span class="math inline">\(x_0 \in V&#39;\)</span> y definimos
<span class="math display">\[
u(x) := \sum_{j=0}^{n-1} f(x_j,x_{j+1})
\]</span>
donde <span class="math inline">\(x_0,x_1, \dots, x_n=x\)</span> es un camino no orientado que conecta <span class="math inline">\(x_0\)</span> con <span class="math inline">\(x\in V&#39;\)</span>.</p>
<p>La hipótesis dada por la ley de ciclos garantiza que esta construcción no depende del camino escogido, es decir que está bien definida sin posible ambigüedad: Dados dos caminos <span class="math inline">\(x_0,\ldots,x_n=x\)</span> y <span class="math inline">\(y_0=x_0,\ldots,y_m=x\)</span> se tiene que <span class="math inline">\(z_0=x_0,\ldots,z_n=x_n,z_{n+1}=y_{m-1},\ldots,z_{n+m}=y_0\)</span> es un ciclo y por lo tanto
<span class="math display">\[
0 = \sum_{j=0}^{n+m-1} f(z_j,z_{j+1}) = \sum_{j=0}^{n-1} f(x_j,x_{j+1}) - \sum_{j=0}^{m-1} f(y_j,y_{j+1}).
\]</span></p>
<p>Veamos finalmente que <span class="math inline">\(Du = f\)</span>. Dado <span class="math inline">\(e\in E\)</span> con <span class="math inline">\(e_\pm\)</span> en la misma componente que <span class="math inline">\(x_0\)</span>, tomamos un camino <span class="math inline">\(x_0,x_1,\ldots, x_n=e_-\)</span> de <span class="math inline">\(x_0\)</span> a <span class="math inline">\(e_-\)</span> y luego añadimos <span class="math inline">\(x_{n+1}=e_+\)</span> para formar un camino de <span class="math inline">\(x_0\)</span> a <span class="math inline">\(e_+\)</span>. Por lo tanto
<span class="math display">\[
Du(e) = u(e_+)-u(e_-) = \sum_{j=0}^{n} f(x_j,x_{j+1})-\sum_{j=0}^{n-1} f(x_j,x_{j+1}) = f(e),
\]</span>
con lo cual concluímos la demostración.</p>
</div>
<p>Este argumento nos permite apreciar que <span class="math inline">\(u\)</span> está únicamente determinado salvo potenciales constantes en cada componente conexa de <span class="math inline">\(G\)</span>. Las constantes son los valores arbitrarios que daríamos a <span class="math inline">\(u\)</span> sobre el nodo <span class="math inline">\(x_0\)</span>, que en nuestra demostración fue cero. En otras palabras, la nulidad del gradiente captura el número de componentes conexas del grafo.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-13" class="exercise"><strong>Ejercicio 2.4  </strong></span>Calcula los potenciales que generan el flujo dado en la siguiente figura</p>
<p><img src="eje_3.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
El flujo satisface la ley de ciclos. Por ejemplo en el triángulo de la izquierda la suma correspondiente es <span class="math inline">\(-3+1+2=0\)</span> y de igual forma podemos verificar en el triángulo de la derecha (<span class="math inline">\(2+(-1)+(-1)=0\)</span>) o en el cuadrado exterior (<span class="math inline">\((-3)+1-(-1)-(-1)=0\)</span>). Si tomamos <span class="math inline">\(u(A)=0\)</span> sin pérdida de generalidad tenemos que
<span class="math display">\[
  \begin{cases}
  u(B) = 1 + u(A) = 1,\\
  u(C) = 3 + u(A) = 3,\\
  u(D) = -1 + u(C) = 2.
  \end{cases}
  \]</span>
Verificamos además que con estos valores se obtiene el gradiente prescrito
<span class="math display">\[
  \begin{cases}
  Du(AB) = u(B)-u(A) = 1-0 = 1,\\
  Du(BC) = u(C)-u(B) = 3-1 = 2,\\
  Du(CA) = u(A)-u(C) = 0-3 = -3,\\
  Du(CD) = u(D)-u(C) = 2-3 = -1,\\
  Du(DB) = u(B)-u(D) = 1-2 = -1.
  \end{cases}
  \]</span>
En general, <span class="math inline">\(u\)</span> tiene el gradiente prescrito si y solo si
<span class="math display">\[
  u(A) = C, \qquad u(B) = 1+C, \qquad u(C) = 3+C, \qquad u(D)=2+C.
  \]</span>
</details>
<hr />
<details>
<summary>
<strong>Margen de cálculo:</strong> El lema de Poincaré
</summary>
<p>Como ya el lector habrá notado, estas construcciones y propiedades encuentran paralelos en cálculo multivariable, y de hecho las demostraciones reproducen las mismas ideas: Los caminos son curvas, los ciclos son lazos o curvas cerradas y la expresión <span class="math inline">\(\sum_{j=0}^{n-1} f(x_j,x_{j+1})\)</span> es análoga a la integral de línea o el trabajo de un campo vectorial sobre una curva.</p>
<p>El resultado que acabamos de enunciar se conoce como el <strong>Lema de Poincaré global</strong>. Recordemos su enunciado junto con el resultado local.</p>
<p><strong>Lema de Poincaré (global):</strong> Un campo vectorial <span class="math inline">\(f \in C(\Omega\subseteq\mathbb R^n\to\mathbb R^n)\)</span> es el gradiente de algún potencial <span class="math inline">\(u\in C^1(\Omega\to\mathbb R)\)</span> si y sólo si para cualquier curva cerrada <span class="math inline">\(\gamma \in C^1([a,b]\to\Omega)\)</span> (i.e. <span class="math inline">\(\gamma(b)=\gamma(a)\)</span>) se tiene que el trabajo que ejerce <span class="math inline">\(f\)</span> sobre la curva <span class="math inline">\(\gamma\)</span> se anula
<span class="math display">\[
\int_\gamma f = \int_a^b f(\gamma(t))\cdot \gamma&#39;(t)dt = 0.
\]</span></p>
<strong>Lema de Poincaré (local):</strong> Si <span class="math inline">\(\Omega\subseteq\mathbb R^n\)</span> es simplemente conexo<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> entonces <span class="math inline">\(f \in C^1(\Omega\to\mathbb R^n)\)</span> es un gradiente si y solo si <span class="math inline">\(\partial_if_j = \partial_jf_i\)</span>.
</details>
</div>
</div>
<div id="divergencia" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Divergencia<a href="cálculo-discreto.html#divergencia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Otro operador diferencial que tiene su análogo en grafos es la divergencia. Heurísticamente, la divergencia de un campo vectorial mide cuando es positiva la cantidad de flujo que sale o diverge del nodo dado, mientras que cuando es negativa mide la cantidad de flujo que recibe o converge en el nodo.</p>
<div class="definition">
<p><span id="def:unlabeled-div-14" class="definition"><strong>Definición 2.4  </strong></span>Dado <span class="math inline">\(f: E \to \mathbb R\)</span> denotamos por <span class="math inline">\(\operatorname{div} f:V\to \mathbb R\)</span> a la divergencia de <span class="math inline">\(f\)</span> donde
<span class="math display">\[
\operatorname{div} f(v) = \sum_{e_-=v}f(e)-\sum_{e_+=v}f(e)
\]</span></p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-15" class="example"><strong>Ejemplo 2.3  </strong></span>En la siguiente figura se calculó la divergencia de la función dada en las aristas</p>
<p><img src="div.png" style="width:70.0%" /></p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-16" class="example"><strong>Ejemplo 2.4  </strong></span>Las ecuaciones de balance para un entramado se escriben en términos de la divergencia de las tensiones sobre los nodos libres como
<span class="math display">\[
\operatorname{div} T = mge_y
\]</span></p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-17" class="example"><strong>Ejemplo 2.5  </strong></span>La ley de Kirchhoff dice que en en un nodo que no está conectado a la batería, la corriente que entra y sale de este son iguales. En términos de la divergencia quiere decir que
<span class="math display">\[
\operatorname{div} i = 0
\]</span></p>
</div>
<hr />
<div id="fórmula-de-la-divergencia" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Fórmula de la divergencia<a href="cálculo-discreto.html#fórmula-de-la-divergencia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Al igual que antes, podríamos preguntarnos si todo potencial es la divergencia de algún campo. Esto no es necesariamente cierto, la divergencia satisface la <strong>ley de conservación</strong>, análoga al teorema de la divergencia. Un caso particular ilustrativo de esta ley postula que la suma de la divergencia sobre un grafo finito es igual a cero
<span class="math display">\[
\sum_{v\in V} \operatorname{div} f(v) = 0.
\]</span>
Una vez más la justificación se basa en una propiedad telescópica para la suma: Cada arista aparece dos veces en la suma con signos opuestos dependiendo si se considera su vértice origen o de llegada.</p>
<p>Para dar una versión discreta del teorema de la divergencia consideramos el campo normal exterior <span class="math inline">\(n_\Omega:E\to \mathbb R\)</span> tal que
<span class="math display">\[
n_\Omega(e) = \begin{cases}
+1 \text{ si $e_-\in \Omega$ y $e_+\in V\setminus \Omega$},\\
-1 \text{ si $e_-\in V\setminus \Omega$ y $e_+\in \Omega$},\\
0 \text{ en cualquier otro caso}
\end{cases}
\]</span>
en este caso el signo de <span class="math inline">\(n_\Omega(e)\)</span> indica cuando la arista orientada conecta a <span class="math inline">\(\Omega\)</span> con su complemento o viceversa.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-18" class="exercise"><strong>Ejercicio 2.5  </strong></span>El campo normal es el gradiente de una dada función ¿Cuál?.</p>
</div>
<details>
<summary>
Solución
</summary>
<span class="math inline">\(n_\Omega = D1_{V\setminus \Omega}\)</span> donde
<span class="math display">\[
  1_{V\setminus \Omega}(x) = \begin{cases}
  1 \text{ si } x\in V\setminus \Omega,\\
  0 \text{ en cualquier otro caso}.
  \end{cases}
  \]</span>
</details>
<hr />
<div class="theorem">
<p><span id="thm:unlabeled-div-19" class="theorem"><strong>Teorema 2.2  (Fórmula de la divergencia) </strong></span>Sea <span class="math inline">\(G=(V,E)\)</span> un grafo dirigido finito y <span class="math inline">\(\Omega \subseteq V\)</span>. La divergencia de <span class="math inline">\(f:E\to \mathbb R\)</span> verifica
<span class="math display" id="eq:div">\[\begin{equation}
\sum_{v\in \Omega} \operatorname{div} f(v) = \sum_{e\in E} f(e)n_\Omega(e)
\tag{2.1}
\end{equation}\]</span></p>
</div>
<p>De hecho la suma en el lado derecho ocurre en realidad sobre un subconjunto de aristas que podemos definir como el borde de <span class="math inline">\(\partial\Omega\)</span>
<span class="math display">\[
\partial \Omega := \{e\in E\ | \ \{e_+,e_-\} \cap \Omega \neq \emptyset \text{ y } \{e_+,e_-\} \cap V\setminus \Omega \neq \emptyset\}.
\]</span>
Es decir las aristas que conectan <span class="math inline">\(\Omega\)</span> con su complemento en cualquier orientación.</p>
<p>La cantidad <span class="math inline">\(f(e)n_\Omega(e)\)</span> es positiva cuando <span class="math inline">\(e_-\in \Omega\)</span>, <span class="math inline">\(e_+\in V\setminus \Omega\)</span> y <span class="math inline">\(f(e)&gt;0\)</span>; o bien cuando <span class="math inline">\(e_-\in V\setminus \Omega\)</span>, <span class="math inline">\(e_+\in \Omega\)</span> y <span class="math inline">\(f(e)&lt;0\)</span>. En cualquier caso, <span class="math inline">\(f(e)n_\Omega(e)\)</span> se interpreta como el flujo que escapa de <span class="math inline">\(\Omega\)</span> por medio de <span class="math inline">\(e\)</span>. Un razonamiento similar se dá cuando <span class="math inline">\(f(e)n_\Omega(e)\)</span> es negativo para el flujo que entra. El balance total nos dice que la masa que se produce o absorbe en <span class="math inline">\(\Omega\)</span> se puede medir de dos formas, sumando las divergencias en <span class="math inline">\(\Omega\)</span> u observando las contribuciones que escapan o entran por las aristas que conectan a <span class="math inline">\(\Omega\)</span> con su complemento <span class="math inline">\(V\setminus \Omega\)</span> en cualquier orientación.</p>
<div class="proof">
<p><span id="unlabeled-div-20" class="proof"><em>Demostración</em>. </span>Sean <span class="math inline">\(1_\pm:V\times E\to \mathbb R\)</span> definidas según
<span class="math display">\[
1_\pm(v,e) := \begin{cases}
1 \text{ si } e_\pm = v,\\
0 \text{ en cualquier otro caso}.
\end{cases}
\]</span>
En particular usaremos que
<span class="math display">\[
\sum_{v\in \Omega} 1_\pm(v,e) = \begin{cases}
1 \text{ si } e_\pm \in \Omega,\\
0 \text{ en cualquier otro caso}
\end{cases}
\]</span></p>
<p>Tenemos así que
<span class="math display">\[
\begin{aligned}
\sum_{v\in \Omega} \operatorname{div} f(v) &amp;= \sum_{v\in \Omega} \sum_{e_-=v} f(e) - \sum_{v\in \Omega} \sum_{e_+=v} f(e),\\
&amp;= \sum_{v\in \Omega} \sum_{e \in E} f(e)1_-(v,e) - \sum_{v\in \Omega} \sum_{e \in E} f(e)1_+(v,e),\\
&amp;= \sum_{e \in E} \sum_{v\in \Omega}f(e)1_-(v,e) - \sum_{e \in E} \sum_{v\in \Omega}f(e)1_+(v,e),\\
&amp;= \sum_{e_-\in \Omega} f(e) -\sum_{e_+\in \Omega} f(e),\\
&amp;= \sum_{\substack{e_-\in \Omega\\e_+\in V\setminus \Omega}} f(e) + \sum_{e_-, e_+\in \Omega} f(e) - \sum_{\substack{e_+\in \Omega\\e_-\in V\setminus \Omega}} f(e) - \sum_{e_-, e_+\in \Omega} f(e),\\
&amp;= \sum_{\substack{e_-\in \Omega\\e_+\in V\setminus \Omega}} f(e) - \sum_{\substack{e_+\in \Omega\\e_-\in V\setminus \Omega}} f(e)
\end{aligned}
\]</span></p>
<p>Esta última expresión es por definición de <span class="math inline">\(n_\Omega\)</span> igual a
<span class="math display">\[
\sum_{e\in E} f(e)n_\Omega(e),
\]</span>
con lo cual se concluye la demostración.</p>
</div>
<details>
<summary>
<strong>Margen de cálculo:</strong> El teorema de la divergencia
</summary>
<p>El teorema de la divergencia nos dice que dado un subconjunto <span class="math inline">\(\Omega \subset\mathbb R^n\)</span> con frontera localmente de clase <span class="math inline">\(C^1\)</span> a trozos, y campo <span class="math inline">\(v\in C^1(\overline{\Omega}\to\mathbb R^n)\)</span>, entonces
<span class="math display">\[
\int_\Omega \operatorname{div} v = \int_{\partial \Omega} v\cdot n
\]</span>
donde <span class="math inline">\(n\)</span> es el vector normal exterior a <span class="math inline">\(\Omega\)</span>.</p>
El lado derecho integra el flujo que escapa o entra en <span class="math inline">\(\Omega\)</span> a través de su borde. En concreto, si en un punto dado del borde <span class="math inline">\(v\cdot n &gt;0\)</span> entonces <span class="math inline">\(v\)</span> apunta en la dirección de <span class="math inline">\(n\)</span> y el flujo escapa con una tasa igual a <span class="math inline">\(v\cdot n\)</span>, si en cambio <span class="math inline">\(v\cdot n &lt; 0\)</span> el flujo estaría entrando, y si <span class="math inline">\(v\cdot n=0\)</span> se tiene que <span class="math inline">\(v\)</span> es tangente y el flujo apenas roza la superficie. El lado izquierdo de la expresión es una integral sobre <span class="math inline">\(\Omega\)</span> que representa la producción/absorción de flujo por el campo <span class="math inline">\(v\)</span>.
</details>
</div>
<div id="lema-de-poincaré-para-la-divergencia" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Lema de Poincaré para la divergencia<a href="cálculo-discreto.html#lema-de-poincaré-para-la-divergencia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="theorem">
<p><span id="thm:unlabeled-div-21" class="theorem"><strong>Teorema 2.3  </strong></span>Sea <span class="math inline">\(G=(V,E)\)</span> un grafo dirigido finito y conexo. Para cualquier <span class="math inline">\(\mu:V\to\mathbb R\)</span> tal que
<span class="math display">\[
\sum_{x\in V}\mu(x)=0
\]</span>
existe por lo menos una solución <span class="math inline">\(f:E\to\mathbb R\)</span> de
<span class="math display">\[
\operatorname{div} f = \mu.
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-22" class="proof"><em>Demostración</em>. </span>Tomemos un nodo arbitrario <span class="math inline">\(x_0\in V\)</span> y consideremos inductivamente caminos no orientados que vayan conectando a <span class="math inline">\(x_0\)</span> con cada uno de los nodos restantes y de tal forma que nunca se formen ciclos en esta construcción. Es decir, estamos proponiendo un <a href="https://en.wikipedia.org/wiki/Spanning_tree"><strong>árbol generador</strong></a> del grafo con raíz en el nodo <span class="math inline">\(x_0\)</span><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Denotaremos dicho árbol por <span class="math inline">\(T_0=(V_0=V,E_0)\)</span>. Fijamos <span class="math inline">\(f=0\)</span> en las aristas de <span class="math inline">\(E\setminus E_0\)</span> y en los demás ajustaremos <span class="math inline">\(f\)</span> para que satisfaga la ecuación dada.</p>
<p>En la siguiente construcción estaremos definiendo a <span class="math inline">\(f:E\cup-E\to \mathbb R\)</span> como una función impar.</p>
<p>La idea consiste en ir podando las ramas del árbol a medida que asignamos <span class="math inline">\(f\)</span> convenientemente. Si <span class="math inline">\(|V_0|=1\)</span> el problema sería trivial, asumamos así que <span class="math inline">\(|V_0|&gt;1\)</span>. En el primer paso tomamos una hoja de <span class="math inline">\(T_0\)</span>, es decir un <span class="math inline">\(x\in V_0\)</span> con un único nodo <span class="math inline">\(y \sim_{T_0} x\)</span>. Declaramos así <span class="math inline">\(f(x,y) = \mu(x)\)</span> de modo que se tiene que <span class="math inline">\(\operatorname{div}f(x) = \mu(x)\)</span>. Una vez declarado <span class="math inline">\(f\)</span> en la arista <span class="math inline">\(e=(x,y)\)</span> procedemos a considerar el árbol <span class="math inline">\(T_1 = (V_0\setminus \{x\},E_1:=E_0\setminus \{(x,y),(y,x)\})\)</span>.</p>
<p>Asumamos de forma inductiva que luego de <span class="math inline">\(k\)</span> pasos contamos con los árboles
<span class="math display">\[
T_k = (V_k,E_k) \subset T_{k-1} := (V_{k-1},E_{k-1}) \subset \ldots \subset T_0
\]</span>
tales que <span class="math inline">\(f\)</span> ha sido definida en <span class="math inline">\(E\setminus E_k\)</span> tal que <span class="math inline">\(\operatorname{div}f=\mu\)</span> se satisface sobre <span class="math inline">\(V\setminus V_k\)</span>. Para el siguiente paso tomamos una hoja <span class="math inline">\(x \in V_k\)</span> y fijamos <span class="math inline">\(f\)</span> sobre la (única) arista <span class="math inline">\((x,y) \in E_k\cup-E_k\)</span> de modo que la ecuación ahora se satisfaga sobre el nodo <span class="math inline">\(x\)</span>. Para el siguiente paso podamos a <span class="math inline">\(x\)</span> de <span class="math inline">\(T_k\)</span>, es decir que
<span class="math display">\[
T_{k+1}:= (V_{k+1}=V_k\setminus\{x\},E_{k+1}:=E_k\setminus\{(x,y),(y,x)\}).
\]</span>
Claramente esta construcción garantiza que las hipótesis inductivas se siguen cumpliendo en el siguiente paso.</p>
<p>Una vez terminado este algoritmo garantizamos que <span class="math inline">\(\operatorname{div} f=\mu\)</span> se cumple en <span class="math inline">\(V\setminus \{x_0\}\)</span> (la raíz del árbol). Como última observación tenemos que la ecuación también debe cumplirse en <span class="math inline">\(x_0\)</span> gracias a que <span class="math inline">\(\sum_{x\in V} \operatorname{div} f(x)=\sum_{x\in V} \mu(x)=0\)</span>.</p>
</div>
<p>Notemos que si <span class="math inline">\(x_0,\ldots,x_k=x_0\)</span> es un dado ciclo del grafo, entonces si tomamos <span class="math inline">\(f=1\)</span> en las aristas del ciclo y cero por fuera de estas, obtenemos una solución de <span class="math inline">\(\operatorname{div} f=0\)</span>. De hecho, todas las soluciones homogéneas se obtienen por superposiciones de este ejemplo. El núcleo de la divergencia es un espacio vectorial generado por los ciclos independientes del grafo y su dimensión es un importante invariante topológico conocido como el <strong>primer número de Betti</strong>.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-23" class="exercise"><strong>Ejercicio 2.6  </strong></span>Calcula los flujos <span class="math inline">\(f:E\to \mathbb R\)</span> tal que <span class="math inline">\(\operatorname{div} f=\mu\)</span> para la función <span class="math inline">\(\mu\)</span> dada sobre los nodos del siguiente grafo.</p>
<p><img src="div2.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
<p>Verificamos primero que la suma de los valores en los nodos se anula.</p>
<p>Para calcular una solución particular tomamos el árbol generador con aristas <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(-e\)</span> y definimos así
<span class="math display">\[
  f(c)=f(d)=0, \qquad f(a)=1, \qquad f(e)=2, \qquad f(b)=0
  \]</span>
el cual verifica fácilmente la ecuación de divergencia esperada en todos los nodos.</p>
Cualquier otra solución se obtiene como la superposición de la solución previa con las del sistema homogéneo
<span class="math display">\[
  \begin{cases}
  f(a)+f(b)-f(e)=0,\\
  -f(a)+f(c)=0,\\
  -f(b)+f(d)=0,\\
  -f(c)-f(d)+f(e)=0.
  \end{cases}
  \]</span>
Dos soluciones linealmente independientes se obtienen por ejemplo de los ciclos <span class="math inline">\(a,c,e\)</span> y <span class="math inline">\(b,d,e\)</span> respectivamente
<span class="math display">\[
  \begin{aligned}
  &amp;f(a)=f(c)=f(e)=1,\qquad f(b)=f(d)=0,\\
  &amp;f(a)=f(c)=0, \qquad f(b)=f(d)=f(e)=1.
  \end{aligned}
  \]</span>
Si usamos la reducción de Gauss-Jordan podemos verificar que esta es además una base de las soluciones homogéneas.
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-24" class="exercise"><strong>Ejercicio 2.7  </strong></span>El primer número de Betti de <span class="math inline">\(G=(V,E)\)</span> es igual a <span class="math inline">\(|E|-|V|+C\)</span> donde <span class="math inline">\(C\)</span> es el número de componentes conexas.</p>
</div>
<details>
<summary>
Solución
</summary>
<p>Asumamos sin pérdida de generalidad que <span class="math inline">\(G\)</span> es conexo, es decir <span class="math inline">\(C=1\)</span>, y en el caso general podemos aplicar el siguiente razonamiento a cada componente conexa de <span class="math inline">\(G\)</span>.</p>
Un árbol generador <span class="math inline">\(T=(V,E_0)\)</span> de <span class="math inline">\(G\)</span> tiene <span class="math inline">\(|V|-1\)</span> aristas. Por definición, cualquier arista en <span class="math inline">\(E\setminus E_0\)</span> cierra un ciclo en <span class="math inline">\(G\)</span> y genera las soluciones triviales del problema <span class="math inline">\(\operatorname{div} f=0\)</span>.
</details>
</div>
</div>
<div id="integración-por-partes" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Integración por partes<a href="cálculo-discreto.html#integración-por-partes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta sección identificamos a las funciones <span class="math inline">\(u:V\to \mathbb R\)</span> con vectores de <span class="math inline">\(\mathbb R^{|V|}\)</span>. Igualmente identificamos a las funciones <span class="math inline">\(f:E\to \mathbb R\)</span> con vectores de <span class="math inline">\(\mathbb R^{|E|}\)</span>. Eventualmente también podríamos considerar funciones complejas.</p>
<p>El gradiente <span class="math inline">\(D:\mathbb R^{|V|}\to\mathbb R^{|E|}\)</span> se representa así por la matriz <span class="math inline">\((D_{e,x}) \in \mathbb R^{|E|\times |V|}\)</span> tal que
<span class="math display">\[
D_{e,x} = \begin{cases}
1 \text{ si } x=e_+,\\
-1 \text{ si } x=e_-,\\
0 \text{ en cualquier otro caso}.
\end{cases}
\]</span>
Mientras que la divergencia <span class="math inline">\(\operatorname{div}:\mathbb R^{|E|}\to\mathbb R^{|V|}\)</span> se representa por la matriz <span class="math inline">\((\operatorname{div}_{x,e}) \in \mathbb R^{|V|\times |E|}\)</span> tal que
<span class="math display">\[
\operatorname{div}_{x,e} = \begin{cases}
-1 \text{ si } e_+=x,\\
1 \text{ si } e_-=x,\\
0 \text{ en cualquier otro caso}.
\end{cases}
\]</span>
Descubrimos de esta forma que <span class="math inline">\(D^T = -\operatorname{div}\)</span> o equivalentemente la fórmula de <strong>integración por partes</strong>
<span class="math display">\[
\sum_{e\in E} (fDu)(e) = f\cdot Du = -u\cdot \operatorname{div} f = -\sum_{x\in V} (u\operatorname{div} f)(x).
\]</span></p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-25" class="exercise"><strong>Ejercicio 2.8  </strong></span>Calcula las matrices asociadas con el gradiente y la divergencia para el siguiente grafo</p>
<p><img src="k3.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
<span class="math display">\[
  D = \begin{pmatrix}
  -1 &amp;  1 &amp;  0 &amp;  0\\
   0 &amp; -1 &amp;  1 &amp;  0\\
   1 &amp;  0 &amp; -1 &amp;  0\\
  -1 &amp;  0 &amp;  0 &amp;  1\\
   0 &amp;  0 &amp;  1 &amp; -1
  \end{pmatrix} \qquad \operatorname{div} = -D^T = \begin{pmatrix}
  1 &amp; 0 &amp; -1 &amp; 1 &amp; 0\\
  -1 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; -1 &amp; 1 &amp; 0 &amp; -1\\
  0 &amp; 0 &amp; 0 &amp; -1 &amp; 1
  \end{pmatrix}.
  \]</span>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-26" class="exercise"><strong>Ejercicio 2.9  </strong></span>Demuestra la fórmula de integración por partes sobre un dominio <span class="math inline">\(\Omega \subseteq V\)</span>
<span class="math display" id="eq:ipv">\[\begin{equation}
\sum_{\Omega} u\operatorname{div}f = \sum_{E} u^-fn_\Omega - \sum_{e_+\in \Omega} fDu.
\tag{2.2}
\end{equation}\]</span>
En particular, si <span class="math inline">\(u=1\)</span> recuperamos la fórmula de la divergencia <a href="cálculo-discreto.html#eq:div">(2.1)</a>.</p>
</div>
<details>
<summary>
Solución
</summary>
Basta con usar que <span class="math inline">\(Dv\cdot f = - v\cdot \operatorname{div} f\)</span> para <span class="math inline">\(v := u 1_{\Omega}\)</span>.
</details>
<hr />
<details>
<summary>
<strong>Margen de cálculo:</strong> Integración por partes en <span class="math inline">\(\mathbb R^n\)</span>
</summary>
La fórmula de integración por partes nos dice que dado un subconjunto <span class="math inline">\(\Omega \subset\mathbb R^n\)</span> con frontera localmente de clase <span class="math inline">\(C^1\)</span> a trozos, un campo <em>vectorial</em> <span class="math inline">\(v\in C^1(\overline{\Omega}\to\mathbb R^n)\)</span>, y un campo <em>escalar</em> <span class="math inline">\(u\in C^1(\overline{\Omega}\to\mathbb R^n)\)</span> entonces
<span class="math display">\[
\int_\Omega u \operatorname{div} v = \int_{\partial \Omega} u (v\cdot n) - \int_\Omega Du\cdot v
\]</span>
donde <span class="math inline">\(n\)</span> es el vector normal exterior a <span class="math inline">\(\Omega\)</span>.
</details>
<div id="descomposición-de-helmholtz" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Descomposición de Helmholtz<a href="cálculo-discreto.html#descomposición-de-helmholtz" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La relación <span class="math inline">\(D^T=-\operatorname{div}\)</span> nos permite dar la descomposición ortogonal
<span class="math display">\[
\mathbb R^{|E|} = D(\mathbb R^{|V|}) + \ker(\operatorname{div}).
\]</span>
también conocida como la <strong>descomposición de Helmholtz</strong>. Es decir que cualquier <span class="math inline">\(f:E\to\mathbb R\)</span> puede escribirse de forma <em>única</em><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> como
<span class="math display">\[
f = Du + g
\]</span>
tal que
<span class="math display">\[
\operatorname{div} g = 0,
\]</span>
y como corolario <span class="math inline">\(Du \perp g\)</span>.</p>
<p>En términos físicos, cualquier flujo se descompone en una parte que preserva la masa (<span class="math inline">\(g\)</span>) y en un flujo gradiente (<span class="math inline">\(Du\)</span>).</p>
<hr />
<details>
<summary>
<strong>Margen de álgebra lineal:</strong> El teorema fundamental de álgebra lineal
</summary>
Dado <span class="math inline">\(A:\mathbb R^M\to \mathbb R^{N}\)</span> se tiene que
<span class="math display">\[
A(\mathbb R^{M})^\perp = \ker(A^T).
\]</span>
Si <span class="math inline">\(x \perp A(\mathbb R^M)\)</span> entonces <span class="math inline">\(0 = x\cdot AA^Tx = \|A^T x\|^2\)</span>, lo cual implica <span class="math inline">\(A^Tx=0\)</span>. Por otro lado si <span class="math inline">\(A^Tx=0\)</span> entonces para <span class="math inline">\(y\in \mathbb R^M\)</span> arbitrario <span class="math inline">\(x\cdot Ay = A^Tx\cdot y=0\)</span>.
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-27" class="exercise"><strong>Ejercicio 2.10  </strong></span>Calcula la descomposición de Helmholtz para el siguiente flujo</p>
<p><img src="helmhotz.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
<p>Sea <span class="math inline">\(f:E\to \mathbb R\)</span> los valores que se muestran en la gráfica. Buscamos calcular <span class="math inline">\(u:V\to \mathbb R\)</span> y <span class="math inline">\(g:E\to \mathbb R\)</span> tales que <span class="math inline">\(f=Du+g\)</span> y <span class="math inline">\(\operatorname{div}g=0\)</span>. Si tomamos así la divergencia en la expresión <span class="math inline">\(f=Du+g\)</span> encontramos que <span class="math inline">\(u\)</span> satisface
<span class="math display">\[
\begin{cases}
-2u(A)+u(B)+u(C)=3,\\
u(A)-3u(B)+u(C)+u(D)=4,\\
u(A)+u(B)-3u(C)+u(D)=-7,\\
u(B)+u(C)-2u(D)=0.
\end{cases}
\]</span>
Las soluciones homogéneas del sistema son los potenciales constantes<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. Ajustando esta constante de forma que <span class="math inline">\(u(A)=0\)</span> obtenemos un sistema que podemos resolver numéricamente</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="cálculo-discreto.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="cálculo-discreto.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="cálculo-discreto.html#cb2-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[ <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb2-4"><a href="cálculo-discreto.html#cb2-4" aria-hidden="true" tabindex="-1"></a>              [<span class="op">-</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb2-5"><a href="cálculo-discreto.html#cb2-5" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">1</span>,<span class="op">-</span><span class="dv">3</span>, <span class="dv">1</span>]])</span>
<span id="cb2-6"><a href="cálculo-discreto.html#cb2-6" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">7</span>])</span>
<span id="cb2-7"><a href="cálculo-discreto.html#cb2-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.linalg.inv(A).dot(B)</span>
<span id="cb2-8"><a href="cálculo-discreto.html#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="cálculo-discreto.html#cb2-9" aria-hidden="true" tabindex="-1"></a>Du <span class="op">=</span> [X[<span class="dv">0</span>],X[<span class="dv">1</span>]<span class="op">-</span>X[<span class="dv">0</span>],<span class="op">-</span>X[<span class="dv">1</span>],X[<span class="dv">2</span>]<span class="op">-</span>X[<span class="dv">1</span>],X[<span class="dv">0</span>]<span class="op">-</span>X[<span class="dv">2</span>]]</span>
<span id="cb2-10"><a href="cálculo-discreto.html#cb2-10" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">5</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb2-11"><a href="cálculo-discreto.html#cb2-11" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> f<span class="op">-</span>Du</span>
<span id="cb2-12"><a href="cálculo-discreto.html#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="cálculo-discreto.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;[Du(AB), Du(BC), Du(CA), Du(CD), Du(DB)] = </span><span class="sc">{}</span><span class="st">.&quot;</span>.<span class="bu">format</span>(Du))</span></code></pre></div>
<pre><code>## [Du(AB), Du(BC), Du(CA), Du(CD), Du(DB)] = [0.125, 2.75, -2.875, -1.375, -1.375].</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="cálculo-discreto.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;[g(AB), g(BC), g(CA), g(CD), g(DB)] = </span><span class="sc">{}</span><span class="st">.&quot;</span>.<span class="bu">format</span>(g))</span></code></pre></div>
<pre><code>## [g(AB), g(BC), g(CA), g(CD), g(DB)] = [0.875 2.25  0.875 1.375 1.375].</code></pre>
</details>
</div>
</div>
<div id="laplaciano" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Laplaciano<a href="cálculo-discreto.html#laplaciano" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El Laplaciano es un operador diferencial que se construye aplicando sucesivamente el gradiente y la divergencia. Es decir que mide la producción de masa del gradiente. Además, luego de una manipulación algebraica, observamos que es proporcional a la diferencia entre el promedio en los vértices adyacentes y el valor en el centro.</p>
<div class="definition">
<p><span id="def:unlabeled-div-28" class="definition"><strong>Definición 2.5  </strong></span>Dado <span class="math inline">\(u: V \to \mathbb R\)</span>, el Laplaciano <span class="math inline">\(\Delta u: V \to \mathbb R\)</span> se define tal que
<span class="math display">\[
\Delta u(v) = \operatorname{div}(D u)(v) = \sum_{w \sim v} (u(w)-u(v)).
\]</span>
donde <span class="math inline">\(w \sim v\)</span> si existe una arista que une a <span class="math inline">\(v\)</span> y <span class="math inline">\(w\)</span> en cualquier orientación.</p>
</div>
<p>A pesar de que tanto el gradiente como la divergencia requieren que el grafo tenga una orientación, <strong>el Laplaciano está bien definido en grafos no dirigidos</strong>.</p>
<p>Cuando <span class="math inline">\(u: V \to \mathbb R\)</span> es un potencial tal que <span class="math inline">\(\Delta u=0\)</span> en <span class="math inline">\(\Omega \subseteq V\)</span>, decimos que <span class="math inline">\(u\)</span> es una función <strong>armónica</strong> sobre <span class="math inline">\(\Omega\)</span>.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-29" class="example"><strong>Ejemplo 2.6  </strong></span>Considera una red eléctrica con resistencias de un Ohm (<span class="math inline">\(R(e)=1\)</span>) la cual modelamos como una grafo dirigido de forma arbitraria. Una batería de un voltio entre dos nodos <span class="math inline">\(v_+,v_-\in V\)</span> genera un potencial eléctrico <span class="math inline">\(u:V\to \mathbb R\)</span> que se puede determinar a partir de la ley de Ohm y la ley de Kirchhoff.</p>
<p>Según la ley de Ohm tenemos que la corriente se calcula según
<span class="math display">\[
i=Du.
\]</span></p>
<p>Según la ley de Kirchhoff tenemos que fuera de los nodos donde se conecta la bateria, la corriente se conserva, es decir
<span class="math display">\[
0=\operatorname{div}i = \Delta u \text{ en } V\setminus\{v_\pm\}
\]</span></p>
<p>Junto con las condiciones de borde en los nodos donde se conecta la batería
<span class="math display">\[
\qquad u(v_+) = 1, \qquad u(v_-) = 0,
\]</span>
obtenemos un sistema de ecuaciones lineales con igual número de ecuaciones que de incógnitas.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-30" class="exercise"><strong>Ejercicio 2.11  </strong></span>Calcula el potencial eléctrico que se genera en un cubo de resistencias de un Ohm, cuando se conecta una batería de un voltio entre dos nodos opuestos del cubo</p>
<p><img src="cube.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
Asumamos sin pérdida de generalidad que se conecta la bateria de los nodos <span class="math inline">\(A\)</span> a <span class="math inline">\(D\)</span> tal que <span class="math inline">\(v(A)=1\)</span> y <span class="math inline">\(v(D)=0\)</span>. Tenemos un sistema de ecuaciones lineales de dimensiones 6 por 6. De existir una única solución<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> observamos que por simetría se debe cumplir que <span class="math inline">\(v(B)=v(F)=v(H)=\alpha\)</span> (los nodos adyacentes a <span class="math inline">\(A\)</span>) y <span class="math inline">\(v(C)=v(E)=v(G)=\beta\)</span> (los nodos adyacentes a <span class="math inline">\(E\)</span>). Esto reduce el sistema a uno de 2 por 2
<span class="math display">\[
  \begin{cases}
  -9\alpha+6\beta = -3,\\
  6\alpha -9\beta = 0
  \end{cases} \qquad\Rightarrow\qquad \alpha = \frac{3}{5}, \qquad \beta = \frac{2}{5}.
  \]</span>
Finalmente es inmediato verificar que con estos valores se obtiene una solución satisfactoria. Más adelante veremos que las soluciones de estos sistemas siempre son únicas (<a href="el-problema-de-dirichlet.html#existencia-y-unicidad-de-soluciones">inyectividad del Laplaciano</a>).
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-31" class="exercise"><strong>Ejercicio 2.12  </strong></span>Calcula la matriz asociada al Laplaciano para el grafo a continuación</p>
<p><img src="k3.png" style="width:70.0%" /></p>
</div>
<details>
<summary>
Solución
</summary>
<span class="math display">\[
  \Delta = \operatorname{div} D = \begin{pmatrix}
  1 &amp; 0 &amp; -1 &amp; 1 &amp; 0\\
  -1 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
  0 &amp; -1 &amp; 1 &amp; 0 &amp; -1\\
  0 &amp; 0 &amp; 0 &amp; -1 &amp; 1
  \end{pmatrix}\begin{pmatrix}
  -1 &amp;  1 &amp;  0 &amp;  0\\
   0 &amp; -1 &amp;  1 &amp;  0\\
   1 &amp;  0 &amp; -1 &amp;  0\\
  -1 &amp;  0 &amp;  0 &amp;  1\\
   0 &amp;  0 &amp;  1 &amp; -1
  \end{pmatrix} = \begin{pmatrix}
  -3 &amp; 1 &amp; 1 &amp; 1\\
  1 &amp; -2 &amp; 1 &amp; 0\\
  1 &amp; 1&amp; -3 &amp; 1\\
  1 &amp; 0 &amp; 1 &amp; -2
  \end{pmatrix}
  \]</span>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-32" class="exercise"><strong>Ejercicio 2.13  </strong></span>Da un análogo discreto para la fórmula de Green
<span class="math display">\[
\int_\Omega (u_1\Delta u_2 - u_2\Delta u_1) = \int_{\partial\Omega} (u_1Du_2 - u_2 Du_1)\cdot n
\]</span></p>
</div>
<details>
<summary>
Solución
</summary>
De la fórmula de integración por partes <a href="cálculo-discreto.html#eq:ipv">(2.2)</a>
<span class="math display">\[
\sum_\Omega u_i \Delta u_j = \sum_{E} u_i^- Du_j n_\Omega - \sum_{e_+\in \Omega} Du_iDu_j
\]</span>
Por lo tanto al tomar la resta se cancelan el segundo término a la deracha quedando así
<span class="math display">\[
\sum_\Omega (u_1 \Delta u_2-u_2 \Delta u_1) = \sum_{E} (u_1^- Du_2 - u_2^- Du_1)n_\Omega.
\]</span>
</details>
<hr />
<p>En general podemos añadir una operación intermedia entre el gradiente y la divergencia. Esto genera operadores con características similares al Laplaciano.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-33" class="example"><strong>Ejemplo 2.7  </strong></span>Considera ahora una red eléctrica con resistencias variables. La ley de Ohm consiste en tomar el gradiente del potencial y luego dividir por las resistencias para obtener la corriente. Al recíproco de la resistencia también se le conoce como la capacitancia y puede ser más conveniente de usar en este ejemplo. En este caso las ecuaciones de balance para el potencial eléctrico tienen la forma
<span class="math display">\[
\operatorname{div} (CDu) = 0 \qquad C = 1/R : \text{Capacitancia}
\]</span>
(fuera de los nodos donde se conecta la batería).</p>
<p>En el caso particular de las resistencias dadas en la siguiente gráfica,</p>
<p><img src="capa.png" style="width:70.0%" /></p>
<p>obtenemos el operador lineal asociado a la siguiente matriz</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="cálculo-discreto.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="cálculo-discreto.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="cálculo-discreto.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradiente</span></span>
<span id="cb6-4"><a href="cálculo-discreto.html#cb6-4" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> np.array([[<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb6-5"><a href="cálculo-discreto.html#cb6-5" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb6-6"><a href="cálculo-discreto.html#cb6-6" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb6-7"><a href="cálculo-discreto.html#cb6-7" aria-hidden="true" tabindex="-1"></a>              [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb6-8"><a href="cálculo-discreto.html#cb6-8" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb6-9"><a href="cálculo-discreto.html#cb6-9" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb6-10"><a href="cálculo-discreto.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Capacitancia (C=1/R)</span></span>
<span id="cb6-11"><a href="cálculo-discreto.html#cb6-11" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb6-12"><a href="cálculo-discreto.html#cb6-12" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb6-13"><a href="cálculo-discreto.html#cb6-13" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb6-14"><a href="cálculo-discreto.html#cb6-14" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dv">0</span>],</span>
<span id="cb6-15"><a href="cálculo-discreto.html#cb6-15" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>]])</span>
<span id="cb6-16"><a href="cálculo-discreto.html#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="cálculo-discreto.html#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Operador L = div(CD)</span></span>
<span id="cb6-18"><a href="cálculo-discreto.html#cb6-18" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="op">-</span>np.matmul(D.T,np.matmul(C,D))</span>
<span id="cb6-19"><a href="cálculo-discreto.html#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="cálculo-discreto.html#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(L)</span></code></pre></div>
<pre><code>## [[-1.7         1.          0.5         0.2       ]
##  [ 1.         -1.25        0.25       -0.        ]
##  [ 0.5         0.25       -1.08333333  0.33333333]
##  [ 0.2        -0.          0.33333333 -0.53333333]]</code></pre>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-34" class="example"><strong>Ejemplo 2.8  </strong></span>Las ecuaciones de balance en los <a href="entramados.html#entramados">entramados</a> se implementan en tres pasos:</p>
<ol style="list-style-type: decimal">
<li><p>Se toman las posiciones relativas entre nodos adyacentes, es decir el gradiente de las posiciones <span class="math inline">\(q:V\to\mathbb R^2\)</span>.</p></li>
<li><p>Se forman las tensiones a partir de las posiciones relativas y los multiplicadores <span class="math inline">\(\lambda:E\to \mathbb R\)</span>.</p></li>
<li><p>Se propone el balance de fuerzas en términos de la divergencia de la tensión.</p></li>
</ol>
<p>En síntesis se obtiene que en los nodos libres
<span class="math display">\[
\operatorname{div} (\lambda D q) = mge_2
\]</span>
A diferencia de los problemas de redes eléctricas, tanto <span class="math inline">\(q\)</span> como <span class="math inline">\(\lambda\)</span> son variables por ser determinadas lo cual hace que el problema sea no-lineal en dichas incógnitas.</p>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>es decir que cualquier ciclo puede ser deformado continuamente a un punto. Por ejemplo, si <span class="math inline">\(n=2\)</span> dice que <span class="math inline">\(\Omega\)</span> no tiene hoyos.<a href="cálculo-discreto.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>En otras palabras un sub-grafo <span class="math inline">\(T_0 := (V_0=V,E_0\subseteq E)\)</span> libre de ciclos y conexo<a href="cálculo-discreto.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Dado <span class="math inline">\(f:E\to \mathbb R\)</span>, el potencial <span class="math inline">\(u\)</span> no es único pero su gradiente <span class="math inline">\(Du\)</span> sí.<a href="cálculo-discreto.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Esto puede verificarse de la reducción de Gauss-Jordan en este caso, y además será demostrado con mayor generalidad.<a href="cálculo-discreto.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Una vez más, esto puede chequearse a mano o con una herramienta numérica.<a href="cálculo-discreto.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="entramados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dinámica.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-calculo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/hchanglara/metodos_mat_aplicadas/blob/master/02-calculo.Rmd",
"text": null
},
"download": ["bookdown_intro.pdf", "bookdown_intro.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
