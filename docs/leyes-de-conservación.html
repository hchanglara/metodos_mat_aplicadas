<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 9 Leyes de conservación | Métodos de matemáticas aplicadas</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 9 Leyes de conservación | Métodos de matemáticas aplicadas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 9 Leyes de conservación | Métodos de matemáticas aplicadas" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Héctor Andrés Chang-Lara" />


<meta name="date" content="2022-09-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cantidades-conservadas.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Métodos de matemáticas aplicadas</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="part"><span><b>Modelos discretos</b></span></li>
<li class="chapter" data-level="1" data-path="entramados.html"><a href="entramados.html"><i class="fa fa-check"></i><b>1</b> Entramados</a></li>
<li class="chapter" data-level="2" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html"><i class="fa fa-check"></i><b>2</b> Cálculo discreto</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#gradiente"><i class="fa fa-check"></i><b>2.1</b> Gradiente</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#ley-de-ciclos"><i class="fa fa-check"></i><b>2.1.1</b> Ley de ciclos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#divergencia"><i class="fa fa-check"></i><b>2.2</b> Divergencia</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#fórmula-de-la-divergencia"><i class="fa fa-check"></i><b>2.2.1</b> Fórmula de la divergencia</a></li>
<li class="chapter" data-level="2.2.2" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#lema-de-poincaré-para-la-divergencia"><i class="fa fa-check"></i><b>2.2.2</b> Lema de Poincaré para la divergencia</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#integración-por-partes"><i class="fa fa-check"></i><b>2.3</b> Integración por partes</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#descomposición-de-helmholtz"><i class="fa fa-check"></i><b>2.3.1</b> Descomposición de Helmholtz</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cálculo-discreto.html"><a href="cálculo-discreto.html#laplaciano"><i class="fa fa-check"></i><b>2.4</b> Laplaciano</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dinámica.html"><a href="dinámica.html"><i class="fa fa-check"></i><b>3</b> Dinámica</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dinámica.html"><a href="dinámica.html#transporte"><i class="fa fa-check"></i><b>3.1</b> Transporte</a></li>
<li class="chapter" data-level="3.2" data-path="dinámica.html"><a href="dinámica.html#difusión"><i class="fa fa-check"></i><b>3.2</b> Difusión</a></li>
<li class="chapter" data-level="3.3" data-path="dinámica.html"><a href="dinámica.html#oscilación"><i class="fa fa-check"></i><b>3.3</b> Oscilación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html"><i class="fa fa-check"></i><b>4</b> Implementación del entramado</a>
<ul>
<li class="chapter" data-level="4.1" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#librerías-y-datos"><i class="fa fa-check"></i><b>4.1</b> Librerías y datos</a></li>
<li class="chapter" data-level="4.2" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#ecuación-diferencial"><i class="fa fa-check"></i><b>4.2</b> Ecuación diferencial</a></li>
<li class="chapter" data-level="4.3" data-path="implementación-del-entramado.html"><a href="implementación-del-entramado.html#integración-y-graficación"><i class="fa fa-check"></i><b>4.3</b> Integración y graficación</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html"><i class="fa fa-check"></i><b>5</b> Espectro del Laplaciano</a>
<ul>
<li class="chapter" data-level="5.1" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#problema-elíptico"><i class="fa fa-check"></i><b>5.1</b> Problema elíptico</a></li>
<li class="chapter" data-level="5.2" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#problema-parabólico"><i class="fa fa-check"></i><b>5.2</b> Problema parabólico</a></li>
<li class="chapter" data-level="5.3" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#problema-hiperbólico"><i class="fa fa-check"></i><b>5.3</b> Problema hiperbólico</a></li>
<li class="chapter" data-level="5.4" data-path="espectro-del-laplaciano.html"><a href="espectro-del-laplaciano.html#nerd-sniping"><i class="fa fa-check"></i><b>5.4</b> Nerd sniping</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html"><i class="fa fa-check"></i><b>6</b> El problema de Dirichlet</a>
<ul>
<li class="chapter" data-level="6.1" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#ley-de-conservación"><i class="fa fa-check"></i><b>6.1</b> Ley de conservación</a></li>
<li class="chapter" data-level="6.2" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#existencia-y-unicidad-de-soluciones"><i class="fa fa-check"></i><b>6.2</b> Existencia y unicidad de soluciones</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#principio-del-mínimo"><i class="fa fa-check"></i><b>6.2.1</b> Principio del mínimo</a></li>
<li class="chapter" data-level="6.2.2" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#método-de-balayage"><i class="fa fa-check"></i><b>6.2.2</b> Método de Balayage</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#fórmulas-de-representación"><i class="fa fa-check"></i><b>6.3</b> Fórmulas de representación</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#la-función-de-green"><i class="fa fa-check"></i><b>6.3.1</b> La función de Green</a></li>
<li class="chapter" data-level="6.3.2" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#el-núcleo-de-poisson"><i class="fa fa-check"></i><b>6.3.2</b> El núcleo de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="el-problema-de-dirichlet.html"><a href="el-problema-de-dirichlet.html#caminatas-aleatorias"><i class="fa fa-check"></i><b>6.4</b> Caminatas Aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="optimización.html"><a href="optimización.html"><i class="fa fa-check"></i><b>7</b> Optimización</a>
<ul>
<li class="chapter" data-level="7.1" data-path="optimización.html"><a href="optimización.html#métrica-de-sobolev"><i class="fa fa-check"></i><b>7.1</b> Métrica de Sobolev</a></li>
<li class="chapter" data-level="7.2" data-path="optimización.html"><a href="optimización.html#capacitancia"><i class="fa fa-check"></i><b>7.2</b> Capacitancia</a></li>
<li class="chapter" data-level="7.3" data-path="optimización.html"><a href="optimización.html#métrica-dual"><i class="fa fa-check"></i><b>7.3</b> Métrica dual</a></li>
<li class="chapter" data-level="7.4" data-path="optimización.html"><a href="optimización.html#cociente-de-rayleigh"><i class="fa fa-check"></i><b>7.4</b> Cociente de Rayleigh</a></li>
</ul></li>
<li class="part"><span><b>Transporte y leyes de conservación</b></span></li>
<li class="chapter" data-level="8" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html"><i class="fa fa-check"></i><b>8</b> Cantidades conservadas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-homogéneos"><i class="fa fa-check"></i><b>8.1</b> Problemas homogéneos</a></li>
<li class="chapter" data-level="8.2" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-no-homogéneos"><i class="fa fa-check"></i><b>8.2</b> Problemas no-homogéneos</a></li>
<li class="chapter" data-level="8.3" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-semi-lineales"><i class="fa fa-check"></i><b>8.3</b> Problemas semi-lineales</a></li>
<li class="chapter" data-level="8.4" data-path="cantidades-conservadas.html"><a href="cantidades-conservadas.html#problemas-cuasi-lineales"><i class="fa fa-check"></i><b>8.4</b> Problemas cuasi-lineales</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html"><i class="fa fa-check"></i><b>9</b> Leyes de conservación</a>
<ul>
<li class="chapter" data-level="9.1" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#teorema-de-transporte"><i class="fa fa-check"></i><b>9.1</b> Teorema de transporte</a></li>
<li class="chapter" data-level="9.2" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#reacción-y-difusión"><i class="fa fa-check"></i><b>9.2</b> Reacción y difusión</a></li>
<li class="chapter" data-level="9.3" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#mecánica-de-medios-continuos"><i class="fa fa-check"></i><b>9.3</b> Mecánica de medios continuos</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#ecuación-de-liouville-y-conservación-de-masa"><i class="fa fa-check"></i><b>9.3.1</b> Ecuación de Liouville y conservación de masa</a></li>
<li class="chapter" data-level="9.3.2" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#conservación-del-momento"><i class="fa fa-check"></i><b>9.3.2</b> Conservación del momento</a></li>
<li class="chapter" data-level="9.3.3" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#teoría-cinética"><i class="fa fa-check"></i><b>9.3.3</b> Teoría cinética</a></li>
<li class="chapter" data-level="9.3.4" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#la-jerarquía-de-bogoliubov-born-green-kirkwood-yvon"><i class="fa fa-check"></i><b>9.3.4</b> La jerarquía de Bogoliubov-Born-Green-Kirkwood-Yvon</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#ecuaciones-de-maxwell"><i class="fa fa-check"></i><b>9.4</b> Ecuaciones de Maxwell</a></li>
<li class="chapter" data-level="9.5" data-path="leyes-de-conservación.html"><a href="leyes-de-conservación.html#distancia-de-wasserstein"><i class="fa fa-check"></i><b>9.5</b> Distancia de Wasserstein</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Métodos de matemáticas aplicadas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="leyes-de-conservación" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Capítulo 9</span> Leyes de conservación<a href="leyes-de-conservación.html#leyes-de-conservación" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En la sección previa hablamos de cantidades conservadas, estas quieren decir funciones que permanecen constantes a lo largo de las trayectorias del sistema. Por <strong>leyes de conservación</strong> entendemos concepto distinto. En este caso la idea tiene que ver con el comportamiento colectivo de una EDO, es decir como el flujo que ella genera transporta densidades.</p>
<p>El flujo <span class="math inline">\(\phi\)</span> generado por el campo <span class="math inline">\(v\)</span> ayuda a entender la evolución puntual del sistema. Es decir, una posición inicial <span class="math inline">\(x_0\)</span> se traslada por la curva <span class="math inline">\(t\mapsto \phi(x_0,t)\)</span>. Esto nos permite también describir la evolución de una colección finita de puntos. Cuando pasamos al continuo tenemos que considerar la evolución de una <strong>distribución</strong> <span class="math inline">\(\mu:\mathbb R^n\times\mathbb R\to\mathbb R\)</span>. Nos referiremos a <span class="math inline">\(\mu\)</span> y sus integrales en dominios dados de <span class="math inline">\(\mathbb R^n\)</span> como la masa.</p>
<p>La mejor forma de entender la dinámica en este caso es apelando a la <strong>ley de conservación de masa</strong>. Fijemos una bola <span class="math inline">\(B_r(x_0)\)</span>, la masa contenida en ella en un tiempo dado es
<span class="math display">\[
m(t) = \int_{B_r(x_0)}\mu(x,t)dx.
\]</span>
Dado que en nuestro modelo, <span class="math inline">\(v\)</span> mueve a la distribución <span class="math inline">\(\mu\)</span> conservando la masa tenemos que la variación de <span class="math inline">\(m\)</span> debe estar determinada por la cantidad neta que entra y sale por la esfera (Figura <a href="leyes-de-conservación.html#fig:cons">9.1</a>). Esta cantidad está determinada por el flujo <span class="math inline">\(f = \mu v\)</span> (flux<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>)
<span class="math display">\[
m&#39;(t) = -\int_{\partial B_r(x_0)} \frac{x-x_0}{r}\cdot f(x,t) \, dx
\]</span>
Es decir que
<span class="math display">\[
\int_{B_r(x_0)}\partial_t\mu(x,t)dx + \int_{\partial B_r(x_0)} \frac{x-x_0}{r}\cdot f(x,t) \, dx = 0.
\]</span></p>
<div class="figure"><span style="display:block;" id="fig:cons"></span>
<img src="cons.PNG" style="width:70.0%" alt="" />
<p class="caption">Figura 9.1:  Ley de conservación</p>
</div>
<p>A partir de esta identidad podemos apelar al teorema de la divergencia o usar la expansión de Taylor para llegar al siguiente resultado cuando <span class="math inline">\(r\to0^+\)</span>. Procedamos con la segunda estrategia, un poco más larga pero más elemental a su vez. Tenemos que
<span class="math display">\[\begin{align*}
\int_{\partial B_r(x_0)} \frac{x-x_0}{r}\cdot f(x,t) \, dx &amp;= \frac{1}{r}\int_{\partial B_r(x_0)} \sum_{i=1}^n (x-x_0)_i\left(f_i(x_0) +\sum_{j=1}^n \partial_j f_i(x_0)(x-x_0)_j + o(r)\right) dx,\\
&amp;= \frac{1}{r}\sum_{i,j=1}^n \partial_jf_i(x_0) \int_{\partial B_r(x_0)} (x-x_0)_i(x-x_0)_j dx + o(r^{n}),\\
&amp;= r^{n}\sum_{i,j=1}^n \partial_jf_i(x_0) \int_{\partial B_1} \theta_i\theta_jd\theta + o(r^{n})
\end{align*}\]</span>
Hemos usado que la integral <span class="math inline">\(\int_{\partial B_r(x_0)} (x-x_0)_idx = 0\)</span> dada la simetría impar del integrando. Las integrales cuadráticas también tienen simetría impar cuando <span class="math inline">\(i\neq j\)</span> y por lo tanto vuelven a cancelarse. Para el caso <span class="math inline">\(i=j\)</span> en cambio tenemos que
<span class="math display">\[
\int_{\partial B_1} \theta_1^2d\theta = \ldots = \int_{\partial B_1} \theta_n^2d\theta = \frac{1}{n}\int_{\partial B_1} (\theta_1^2 + \ldots+\theta_n^2)d\theta = \frac{|\partial B_1|}{n} = |B_1|.
\]</span>
En conclusión
<span class="math display">\[
\int_{\partial B_r(x_0)} \frac{x-x_0}{r}\cdot f(x,t) \, dx = |B_r|\operatorname{div} f(x_0) + o(r^{n}).
\]</span></p>
<p>Volviendo a la ley de conservación de masa obtenemos que dividiendo por <span class="math inline">\(|B_r|\)</span> y tomando el límite <span class="math inline">\(r\to0^+\)</span>
<span class="math display">\[
\partial_t\mu + \operatorname{div} f = \partial_t\mu + \operatorname{div}(\mu v) = 0.
\]</span></p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-124" class="exercise"><strong>Ejercicio 9.1  </strong></span>Verifica que para <span class="math inline">\(u:\mathbb R^n\to\mathbb R\)</span> de clase <span class="math inline">\(C^2\)</span>,
<span class="math display">\[
\lim_{r\to0^+} \frac{1}{r^2|\partial B_r|}\int_{\partial B_r} (u(x)-u(0))dx = \frac{1}{2n}\Delta u(0).
\]</span></p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<div id="teorema-de-transporte" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Teorema de transporte<a href="leyes-de-conservación.html#teorema-de-transporte" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dicho de otra forma, la ley de conservación dicta que el flujo <span class="math inline">\(\phi_t := \phi(\cdot,t)\)</span> generado por <span class="math inline">\(v\)</span> empuja a la densidad inicial <span class="math inline">\(\mu_0 := \mu(0) := \mu(\cdot,0)\)</span> en la densidad <span class="math inline">\(\mu_t := \mu(t) := \mu(\cdot,t)\)</span>.</p>
<p>Para ser precisos, definimos que un mapeo <span class="math inline">\(T:\mathbb R^n\to\mathbb R^n\)</span> <strong>empuja</strong><a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> a <span class="math inline">\(\mu_0\)</span> en <span class="math inline">\(\mu_1 =: T_\#\mu_0\)</span> si preserva las medidas según la siguiente identidad (Figura <a href="leyes-de-conservación.html#fig:push">9.2</a>)
<span class="math display">\[
\int_{T^{-1}(B_r(y_0))} \mu_0(x)dx = \int_{B_r(y_0)} \mu_1(y)dy \qquad\forall \, B_r(y_0)\subseteq\mathbb R^n.
\]</span>
Equivalentemente, gracias a la fórmula de cambio de variables
<span class="math display">\[
(\mu_1\circ T)\det DT = \mu_0.
\]</span></p>
<div class="figure"><span style="display:block;" id="fig:push"></span>
<img src="push.PNG" style="width:70.0%" alt="" />
<p class="caption">Figura 9.2:  Push-foward</p>
</div>
<p>Nuestro objetivo en esta sección consiste así en demostrar que si <span class="math inline">\(\mu\)</span> satisface la ley de conservación <span class="math inline">\(\mu_t\)</span> y <span class="math inline">\(\phi\)</span> es el flujo generado por <span class="math inline">\(v\)</span>, entonces
<span class="math display">\[
\mu(\phi_t(x),t)\det(D\phi_t) = \mu(x,0).
\]</span></p>
<p>El escenario en una dimensión es una ilustrativa aplicación de la regla de la cadena en varias variables.</p>
<p>Sea <span class="math inline">\(I=[a,b]\)</span> un intervalo arbitrario. El flujo manda este intervalo a el intervalo <span class="math inline">\(I_t = [a(t),b(t)]\)</span> donde <span class="math inline">\(a(t) = \phi(a,t)\)</span> y <span class="math inline">\(b(t) = \phi(b,t)\)</span>. Queremos verificar entonces que si <span class="math inline">\(\mu\)</span> satisface la ley de conservación, entonces
<span class="math display">\[
\int_{a(t)}^{b(t)} \mu(x,t)dx = \int_{a}^{b} \mu(x,0)dx.
\]</span>
Basta ver que el lado izquierdo es constante en <span class="math inline">\(t\)</span>.</p>
<p>Cuando tomamos la derivada debemos tener cuidado en que la expresión debe involucrar tanto el teorema fundamental del cálculo como también la linealidad de la integral (es decir que podemos pasar la derivada dentro de la integral). Para ser precisos definimos
<span class="math display">\[
\psi(\alpha,\beta,\gamma) := \int_{\alpha}^{\beta} \mu(x,\gamma)dx,
\]</span>
por lo que la expresión que buscamos diferenciar es la composición <span class="math inline">\(\psi(a(t),b(t),t)\)</span>. Por la regla de la cadena seguida del teorema fundamental del cálculo
<span class="math display">\[\begin{align*}
    \frac{d}{dt}\int_{a(t)}^{b(t)} \mu(x,t)dx &amp;= \partial_\alpha\psi \alpha&#39;+\partial_\beta\psi \beta&#39;+\partial_\gamma\psi \gamma&#39;,\\
    &amp;= -\mu(x,a(t))v(a(t),t) + \mu(x,b(t))v(b(t),t) + \int_{a(t)}^{b(t)} \partial_t\mu(x,t)dx,\\
    &amp;= -\mu(x,a(t))v(a(t),t) + \mu(x,b(t))v(b(t),t) - \int_{a(t)}^{b(t)} \partial_x(\mu(x,t)v(x,t))dx,\\
    &amp;= 0.
\end{align*}\]</span>
Esto demuestra así la propiedad geométrica anunciada.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-125" class="exercise"><strong>Ejercicio 9.2  </strong></span>Verifica que para <span class="math inline">\(f:\mathbb R\to\mathbb R\)</span> continua,
<span class="math display">\[
y(t) = \int_0^t f(s)\sin(t-s)ds
\]</span>
es una solución particular de la ecuación <span class="math inline">\(y&#39;&#39; + y = f\)</span>.</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<p>En el caso de dimensión general procedemos a verificar que <span class="math inline">\((\mu_t\circ\phi_t)\det D\phi_t\)</span> no depende de <span class="math inline">\(t\)</span>. Derivamos así,
<span class="math display">\[
\frac{d}{dt}[(\mu_t\circ\phi_t)\det D\phi_t] = (\partial_t\mu+v\cdot D\mu)\det D\phi_t + \mu \frac{d}{dt}\det D\phi_t
\]</span>
Usando ahora la identidad para la derivada del determinante
<span class="math display">\[
(\ln \det M(t))&#39; = \operatorname{tr}(M(t)^{-1}M&#39;(t))
\]</span>
obtenemos que
<span class="math display">\[
\begin{aligned}
\frac{d}{dt}[(\mu_t\circ\phi_t)\det D\phi_t] &amp;= (\partial_t\mu+v\cdot D\mu+\mu \operatorname{div} v)\det D\phi_t\\
&amp;= (\partial_t\mu+\operatorname{div}(\mu v))\det D\phi_t\\
&amp;= 0.
\end{aligned}
\]</span>
Tenemos así que
<span class="math display">\[
(\mu_t\circ\phi_t)\det D\phi_t=(\mu_0\circ\phi_0)\det D\phi_0=\mu_0,
\]</span>
con lo cual concluimos <span class="math inline">\(\mu_t = (\phi_t)_\#\mu_0\)</span>.</p>
<hr />
<details>
<summary>
<strong>Margen de cálculo</strong>
</summary>
<p>La derivada logarítmica del determinante o el teorema de Liouville. El determinante es una función multilineal en las columnas, como tal satisface la regla del producto (misma demostración)
<span class="math display">\[
\frac{d}{dt}\det (m_1(t),\ldots,m_n(t)) = \det (m_1&#39;(t),\ldots,m_n(t)) +
\ldots + \det (m_1(t),\ldots,m_n&#39;(t))
\]</span></p>
Si <span class="math inline">\(M(t_0) = I\)</span> entonces
<span class="math display">\[
\left.\frac{d}{dt}\right|_{t=t_0}\det (m_1(t),\ldots,m_n(t)) = \operatorname{tr} M&#39;(t_0).
\]</span>
Para <span class="math inline">\(M(t_0)=M_0\)</span> invertible usamos que <span class="math inline">\(M(t) = M_0 N(t)\)</span> tal que
<span class="math display">\[
\left.\frac{d}{dt}\right|_{t=t_0}\det (m_1(t),\ldots,m_n(t)) = \det(M_0) \operatorname{tr} N&#39;(t_0) = \det(M_0) \operatorname{tr} (M_0^{-1}M&#39;(t_0)).
\]</span>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-126" class="exercise"><strong>Ejercicio 9.3  </strong></span>Sea <span class="math inline">\(\phi\)</span> el flujo generado por <span class="math inline">\(v\)</span> y <span class="math inline">\(E_t=\phi_t(E)\)</span> donde <span class="math inline">\(E\subseteq\mathbb R^n\)</span> tiene frontera regular. Demuestra que para <span class="math inline">\(f:\mathbb R^n\times\mathbb R\to\mathbb R\)</span> de clase <span class="math inline">\(C^1\)</span>
<span class="math display">\[
\frac{d}{dt}\int_{E_t}f = \int_{E_t}\partial_t f + \int_{\partial E_t}f(v\cdot n_t),
\]</span>
donde <span class="math inline">\(n_t\)</span> es el vector normal exterior de <span class="math inline">\(E_t\)</span></p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-127" class="exercise"><strong>Ejercicio 9.4  </strong></span>Grafica <span class="math inline">\(\mu(\cdot,t)\)</span> para <span class="math inline">\(t\in \{0,0.2,0.4,0.6,0.8,1\}\)</span> si
<span class="math display">\[
\partial_t\mu + \partial_x(x^2\mu) = 0, \qquad \mu(x,0) = \exp(-(x-1)^2)+5\exp(-10(x+2)^2).
\]</span></p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<p>Un modelo razonable para el tráfico en una dimensión consiste en considerar que el flujo está dado por <span class="math inline">\(f(\mu) = \mu v(\mu)\)</span> y que la velocidad es una función con la siguiente características: Es no-negativa y decreciente. Es decir que los agentes se mueven de izquierda a derecha y que a mayor densidad, menor la velocidad y viceversa. Si <span class="math inline">\(\mu\)</span> toma valores en el intervalo <span class="math inline">\([0,\mu_{max}]\)</span> tenemos por ejemplo el modelo logístico
<span class="math display">\[
f(\mu) = v_m\mu(1-\mu/\mu_{max})
\]</span>
donde <span class="math inline">\(v_m&gt;0\)</span> es la velocidad máxima. La ley de conservación correspondiente se conoce como la <strong>ecuación de tráfico</strong>
<span class="math display">\[
\partial_t \mu + v_m\partial_x(\mu(1-\mu/\mu_{max})) = 0 \text{ en } \mathbb R\times(0,\infty)
\]</span></p>
<p>Para los siguiente ejercicios consideramos el problema de tráfico con configuración inicial
<span class="math display">\[
\mu(x,0) = \begin{cases}
\mu_{max} \text{ si } x&lt;0\\
0 \text{ si } x\geq0
\end{cases}
\]</span>
Esto modela el escenario donde los carros pueden estar detenidos inicialmente por un semáforo que luego cambia a tener luz verde.</p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-128" class="exercise"><strong>Ejercicio 9.5  </strong></span>Calcula las soluciones de las ecuaciones características. Observa que existe una región de <span class="math inline">\(\mathbb R\times(0,\infty)\)</span> que no pareciera estar cubierta por las trayectorias. Calcula la cantidad de tiempo que debe esperar un agente inicialmente ubicado en <span class="math inline">\(x_0&lt;0\)</span> para comenzar a moverse (es decir tener velocidad positiva) luego de que el semáforo ha cambiado a verde.</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-129" class="exercise"><strong>Ejercicio 9.6  </strong></span>Aproxima la condición inicial por <span class="math inline">\(\mu_\varepsilon(x,0) = \mu_{max} (1/2-\arctan(x/\varepsilon)/\pi)\)</span> (para <span class="math inline">\(\varepsilon&gt;0\)</span>) y observa que este caso el método de las características si permite definir una solución. ¿Qué sucede en el límite cuando <span class="math inline">\(\varepsilon\to0^+\)</span>?</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
</div>
<div id="reacción-y-difusión" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Reacción y difusión<a href="leyes-de-conservación.html#reacción-y-difusión" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los modelos con <strong>reacciones</strong> son extensiones a la ecuación de conservación, en este caso se considera una función <span class="math inline">\(f\)</span> que según el problema de interés se puede considerar como una fuente o sumidero para la densidad <span class="math inline">\(\mu\)</span>
<span class="math display">\[\partial_t \mu + \operatorname{div}(\mu v)=f\]</span></p>
<p>En su forma integral
<span class="math display">\[
\frac{d}{dt} \int_E \mu=-\int_{\partial E}\mu v \cdot n+\int_E f.
\]</span></p>
<p>Nótese que esta forma integral no es más que un balance de masa en el conjunto de prueba <span class="math inline">\(E\)</span>. El término <span class="math inline">\(\int_E f\)</span> indica la cantidad de materia que se produce o consume en <span class="math inline">\(E\)</span>.</p>
<p>Las leyes de <strong>Darcy</strong>, <strong>Fick</strong> o <strong>Fourier</strong> proponen la misma hipótesis aunque en distintos contextos (fluídos, difusiones y calor respectivamente). Cada una de ellas prescribe que el flujo es proporcional al gradiente de la concentración, es decir
<span class="math display">\[
\mu v=-kD \mu \hspace{1cm} (k &gt; 0).
\]</span>
Como tal describe el transporte de regiones de mayor a menos concentraciones de <span class="math inline">\(\mu\)</span>. Junto con la ley de conservación esta describe la <strong>ecuación de difusión o calor</strong>
<span class="math display">\[\partial_t \mu =k \Delta \mu\]</span></p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-130" class="example"><strong>Ejemplo 9.1  </strong></span>Un modelo de quimiotaxis describe la evolución de una densidad de bacterias <span class="math inline">\(\rho\)</span> y una densidad química <span class="math inline">\(\varphi\)</span> que atrae dicha población. Esto puede ser representado por las siguientes ecuaciones
<span class="math display">\[
\begin{aligned}
    &amp;\partial_t \rho+\operatorname{div}(\alpha \rho D \varphi)=0,\\
    &amp;\partial_t \varphi=\beta \rho-k \varphi.
\end{aligned}
\]</span></p>
<p>La población de bacterias busca moverse en la dirección donde <span class="math inline">\(\varphi\)</span> crece, es decir tiene un flujo proporcional a <span class="math inline">\(D\varphi\)</span>, lo cual está reflejado en la primera ecuación. A su vez las bacterias son productoras de la misma sustancia <span class="math inline">\(\varphi\)</span> que además tiene un decaimiento exponencial, esto es lo que refleja la segunda ecuación del sistema.</p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-131" class="example"><strong>Ejemplo 9.2  </strong></span>Recordemos el modelo básico epidemiológico para dos tipos de poblaciones, suseptibles (<span class="math inline">\(S\)</span>) e infectados (<span class="math inline">\(I\)</span>)
<span class="math display">\[
\begin{aligned}
S&#39;&amp;=-\beta IS\\
I&#39;&amp;= \beta IS-\gamma I.
\end{aligned}
\]</span></p>
<p>Una extensión a este modelo es considerar el efecto de las migraciones con flujos <span class="math inline">\(v_S\)</span> y <span class="math inline">\(v_I\)</span> respectivamente, es decir
<span class="math display">\[
\begin{aligned}
\begin{cases}
\partial_t S +\operatorname{div}(Sv_s) = -\beta IS,\\
\partial_t I +\operatorname{div}(Iv_I) = \beta IS-\gamma I.
\end{cases}
\end{aligned}
\]</span></p>
</div>
</div>
<div id="mecánica-de-medios-continuos" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Mecánica de medios continuos<a href="leyes-de-conservación.html#mecánica-de-medios-continuos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consideremos las ecuaciones de Newton para un sistema de <span class="math inline">\(N\)</span> partículas en <span class="math inline">\(\mathbb R^d\)</span> cuyas masas y posiciones denotamos por <span class="math inline">\(m=(m_1,\ldots,m_N) \in \mathbb R^N\)</span> y <span class="math inline">\(x=(x_1,\ldots,x_N) \in \mathbb R^{dN}\)</span> respectivamente
<span class="math display">\[
mx&#39;&#39;=f(x).
\]</span>
Equivalentemente presentamos al sistema como uno de primer orden cuando tomamos las velocidades <span class="math inline">\(v\in \mathbb R^{dN}\)</span> tales que
<span class="math display">\[
\begin{cases}
x&#39;=v,\\
mv&#39;=f(x).
\end{cases}
\]</span>
De forma alternativa, si tomamos <span class="math inline">\(y:=(x,v)\)</span>, <span class="math inline">\(F(y) := (v,a(x))\)</span> y <span class="math inline">\(a(x):= m^{-1}f(x)\)</span> (aceleración), entonces <span class="math inline">\(y&#39;=F(y)\)</span>.</p>
<p>Cuando <span class="math inline">\(N\)</span> es muy grande es prácticamente imposible describir las trayectorias individuales del sistema. Sin embargo es posible comprender el comportamiento colectivo modelado por medio de una densidad <span class="math inline">\(\rho=\rho(y,t) = \rho(x,v,t)\)</span> en el espacio de configuraciones para las posiciones y velocidades. Tomaremos como hipótesis que <span class="math inline">\(\rho\)</span> además de ser una función suficientemente suave decae a cero suficientemente rápido cuando <span class="math inline">\(|(x,v)|\to \infty\)</span>.</p>
<p>Consideraremos a su vez la distribución de partículas en espacio dada por la marginal de <span class="math inline">\(\rho\)</span> sobre las posiciones en <span class="math inline">\(x\in\mathbb R^d\)</span>,
<span class="math display">\[
\mu(x) = \int_{\mathbb R^d}\rho(x,v)dv.
\]</span>
Sobre el conjunto donde <span class="math inline">\(\mu&gt;0\)</span> consideramos la velocidad promedio
<span class="math display">\[
u := \frac{1}{\mu} \int_{\mathbb R^d} v\rho dv.
\]</span>
y su tensor de covarianza
<span class="math display">\[
T := \frac{1}{\mu} \int_{\mathbb R^d} (v-u)\otimes(v-u) \rho dv = \frac{1}{\mu} \int_{\mathbb R^d} (v\otimes v) \rho dv - u\otimes u.
\]</span>
Observemos que <span class="math inline">\(\mu T\)</span> tiene unidades de energía, este es el <strong>tensor de tensión</strong>.</p>
<div id="ecuación-de-liouville-y-conservación-de-masa" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Ecuación de Liouville y conservación de masa<a href="leyes-de-conservación.html#ecuación-de-liouville-y-conservación-de-masa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Asumamos que para una partícula en <span class="math inline">\(x\in\mathbb R^d\)</span> de masa unitaria, la aceleración queda determinada por <span class="math inline">\(a=a(x,\mu)\)</span>, es decir una función que depende de la distribución de las demás partículas en espacio.</p>
<p>Consideremos por un momento que <span class="math inline">\(\mu = \int \rho dv\)</span> ya está determinada, y por lo tanto la aceleración <span class="math inline">\(a=a(x,\mu(\cdot,t))\)</span>, es una función conocida de <span class="math inline">\((x,t)\)</span>. Dado el campo vectorial <span class="math inline">\(F(x,v,t) = (v,a)\)</span>, tenemos la siguiente ley de conservación para la distribución <span class="math inline">\(\rho\)</span>
<span class="math display">\[
\partial_t\rho + \operatorname{div}(\rho F) = 0
\]</span>
Esta se simplifica en la <strong>ecuación de Liouville</strong> usando que <span class="math inline">\(\operatorname{div} F = \operatorname{div}_x v + \operatorname{div}_v a = 0\)</span>,
<span class="math display">\[
\partial_t\rho + v\cdot D_x\rho + a\cdot D_v\rho=0.
\]</span></p>
<p>Cuando integramos la ecuación de Liouville con respecto a <span class="math inline">\(v\)</span> obtenemos la ley de <strong>conservación de masa</strong>
<span class="math display">\[
0=\partial_t \mu +  D_x\int_{\mathbb R^d}\rho vdv +a\cdot \int_{\mathbb R^d} D_v \rho dv = \partial_t \mu + \operatorname{div}(\mu u).
\]</span>
Recordemos que <span class="math inline">\(u\)</span> es el promedio de las velocidades. El término de aceleración se cancela gracias al teorema de la divergencia
<span class="math display">\[
\int_{\mathbb R^d} \partial_{v_j} \rho dv = \int_{\mathbb R^d} \operatorname{div}_v(\rho e_j) dv = 0.
\]</span></p>
<p>Cuando <span class="math inline">\(\mu\)</span> es constante decimos que el material en cuestión es <strong>incompresible</strong> y la ecuación de conservación de masa se reduce a
<span class="math display">\[
\operatorname{div} u = 0.
\]</span></p>
<p>Retomando que la aceleración <span class="math inline">\(a=a(x,\mu)\)</span> depende de <span class="math inline">\(\mu\)</span> debemos considerar que la ecuación de Liouville viene acoplada a la ley de conservación de masa
<span class="math display">\[
\begin{cases}
\partial_t\rho + v\cdot D_x\rho + a(\mu)\cdot D_v\rho=0,\\
\partial_t \mu + \operatorname{div}(\mu u) = 0,\\
u=\frac{1}{\mu}\int \rho vdv.
\end{cases}
\]</span></p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-132" class="example"><strong>Ejemplo 9.3  </strong></span>Asumamos ahora que las partículas interactúan a pares por medio de una misma fuerza conservativa con potencial <span class="math inline">\(U:\mathbb R^d\to \mathbb R\)</span> de clase <span class="math inline">\(C^1\)</span>. Es decir que la partícula en <span class="math inline">\(y\)</span> de masa unitaria ejerce una fuerza igual a <span class="math inline">\(-DU(x-y)\)</span> sobre una partícula en <span class="math inline">\(x\)</span>, también de masa unitaria.\</p>
<p>Dada la distribución <span class="math inline">\(\mu\)</span> de partículas, tenemos que por el principio de superposición la aceleración neta sobre la posición <span class="math inline">\(x\)</span> está dada según
<span class="math display">\[
a(x) = -\int DU(x-y)\mu(y)dy = -(DU\ast \mu)(x).
\]</span>
El problema de Liouville en este caso se conoce como la <strong>ecuación de Vlasov</strong>
<span class="math display">\[
\partial_t \rho + v\cdot D_x\rho = (DU\ast \mu)\cdot D_v\rho.
\]</span></p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-133" class="example"><strong>Ejemplo 9.4  </strong></span>Para <span class="math inline">\(d=3\)</span> y <span class="math inline">\(U(x) = |x|^{-1}\)</span> estamos modelando las fuerzas gravitatorias y <span class="math inline">\(U\)</span> se conoce como el <strong>potencial de Newton</strong>. En este caso la convolución <span class="math inline">\(U_\mu := U\ast \mu\)</span> es la solución de la ecuación de Poisson <span class="math inline">\(\Delta u = -\mu\)</span> en <span class="math inline">\(\mathbb R^3\)</span> con decaimiento en infinito. Tenemos así las <strong>ecuaciones de Vlasov-Poisson</strong> dadas por
<span class="math display">\[
\begin{cases}
\partial_t \rho + v\cdot D_x\rho = D_x u \cdot D_v\rho,\\
\Delta u = -\int \rho dv.
\end{cases}
\]</span></p>
</div>
<hr />
<p>Bajo la perspectiva Hamiltoniana de la mecánica, las ecuaciones de Newton toman la siguiente forma
<span class="math display">\[
x&#39; = D_pH, \qquad p&#39;= -D_xH, \qquad H(x,p) = \frac{1}{2m}|p|^2 + U(x).
\]</span>
Es decir que el par <span class="math inline">\((x,p)\)</span> evoluciona de acuerdo al gradiente de la energía <span class="math inline">\(H\)</span>, pero modulado de la siguiente forma
<span class="math display">\[
\frac{d}{dt}\begin{pmatrix}
x\\p
\end{pmatrix} = \begin{pmatrix}
0&amp;I\\
-I&amp;0
\end{pmatrix}DH.
\]</span>
El lado derecho se conoce como el <strong>gradiente simpléctico</strong> de <span class="math inline">\(H\)</span>.</p>
<p>Las ecuaciones de Liouville para <span class="math inline">\(\rho=\rho(x,p)\)</span><a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> pueden escribirse así en términos de <span class="math inline">\(H\)</span> por medio del <strong>corchete de Poisson</strong> como
<span class="math display">\[
\partial_t \rho + \{H,\rho\} = 0, \qquad \{f,g\} := \begin{pmatrix}
0&amp;I\\
-I&amp;0
\end{pmatrix}Df \cdot Dg = D_xf \cdot D_p g - D_p f D_xg.
\]</span></p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-134" class="example"><strong>Ejemplo 9.5  </strong></span>Cuando <span class="math inline">\(\{H,\rho\}=0\)</span> entonces <span class="math inline">\(f\)</span> es una <strong>cantidad conservada del sistema mecánico</strong> dado que el flujo simpléctico generado por <span class="math inline">\(H\)</span> deja a <span class="math inline">\(\rho\)</span> invariante. El <strong>teorema de Noether</strong> establece que esto ocurre si y solo si los flujos generados por los gradientes simplécticos de <span class="math inline">\(H\)</span> y <span class="math inline">\(\rho\)</span> conmutan. Al flujo simpléctico generado por <span class="math inline">\(\rho\)</span> se le conoce así como una <strong>simetría del sistema mecánico</strong>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-135" class="exercise"><strong>Ejercicio 9.7  </strong></span>Verifica las siguiente propiedades del corchete de Poisson las cuales dan una estructura de álgebra de Lie al espacio de funciones en <span class="math inline">\(\mathbb R^{2N}\)</span>:</p>
<ul>
<li><p><strong>Anti-simetría:</strong> <span class="math inline">\(\{f,g\}=-\{g,f\}\)</span>,</p></li>
<li><p><strong>Jacobi (ley del producto):</strong> <span class="math inline">\(\{f,\{g,h\}\} = \{\{f,g\},h\}+\{g,\{f,h\}\}\)</span></p></li>
</ul>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-136" class="exercise"><strong>Ejercicio 9.8  </strong></span>Verifica las siguientes funciones son cantidades conservadas con respecto de <span class="math inline">\(H\)</span> para <span class="math inline">\(\phi\)</span> y <span class="math inline">\(\psi\)</span> funciones reales de clase <span class="math inline">\(C^1\)</span> arbitrarias:</p>
<ul>
<li><p><span class="math inline">\(\rho=\phi(H)\)</span>,</p></li>
<li><p><span class="math inline">\(\rho = \psi(|DH|^2)\)</span>.</p></li>
</ul>
<p>Casos particulares de los ejercicios anteriores son el ensamble canónico y micro-canónico de la mecánica estadística.</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
</div>
<div id="conservación-del-momento" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Conservación del momento<a href="leyes-de-conservación.html#conservación-del-momento" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Buscamos ahora obtener una ecuación que describa la dinámica de la velocidad <span class="math inline">\(u\)</span>. Al igual que antes seguimos asumiendo que la aceleración es independiente de <span class="math inline">\(v\)</span>.</p>
<p>Cuando multiplicamos la ecuación de Liouville por <span class="math inline">\(v\)</span> e integramos con respecto de <span class="math inline">\(v\)</span> obtenemos la <strong>ley de conservación del momento</strong>
<span class="math display">\[
\begin{aligned}
0 &amp;= \partial_t(\mu u) + \int_{\mathbb R^d} (v\cdot D_x\rho+a\cdot D_v\rho)vdv,\\
&amp;= \partial_t(\mu u) + \operatorname{div} \int_{\mathbb R^d} (v\otimes v) \rho dv + \int_{\mathbb R^d}(v\otimes D_v\rho)adv,\\
&amp;= \partial_t(\mu u) + \operatorname{div}(\mu(u\otimes u) + T) - \mu a.\\
\end{aligned}
\]</span>
En la última igualdad hemos usado integración por partes para llegar a que <span class="math inline">\(\int (v\otimes D_v\rho)dv=-\mu I\)</span>. Fijémonos que sucede con la <span class="math inline">\(j\)</span>-ésima fila de dicha matriz
<span class="math display">\[
\int_{\mathbb R^d}v_jD_v\rho dv = -\int_{\mathbb R^d} e_j\rho dv = -e_j\mu.
\]</span></p>
<p>Usando la ley de conservación de masa en el término <span class="math inline">\(\partial_t(\mu u)\)</span> obtenemos que
<span class="math display">\[
\begin{aligned}
\partial_t(\mu u) &amp;= \mu\partial_t u - \operatorname{div}(\mu u)u,\\
&amp;= \mu(\partial_tu+ u\cdot Du) - \operatorname{div}(\mu(u\otimes u))
\end{aligned}
\]</span>
Por lo tanto, la ecuación de Euler se escribe también como
<span class="math display">\[
\mu(\partial_t u+u\cdot Du) = -\operatorname{div} T + f.
\]</span></p>
<p>En distintas aplicaciones se separa a <span class="math inline">\(T\)</span> como un múltiplo de la identidad y una matriz libre de traza. Definimos de esta forma la <strong>presión</strong> y el <strong>tensor de estrés</strong> (unidades de energía) respectivamente según
<span class="math display">\[
p := \frac{\mu}{d} \operatorname{tr} T, \qquad \sigma := \mu T- p I.
\]</span>
por lo que llegamos a la siguiente presentación de las ecuaciones de Euler
<span class="math display">\[
\mu(\partial_t u+u\cdot Du) = -Dp - \operatorname{div}\sigma + f.
\]</span>
Notemos que el lado izquierdo representa el transporte de la velocidad (multiplicado por la densidad <span class="math inline">\(\mu\)</span>), mientras que en el lado derecho aparecen tres tipos de fuerzas, siendo las dos primeras internas al medio.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-137" class="example"><strong>Ejemplo 9.6  </strong></span>Las <strong>ecuaciones de Euler</strong> resultan cuando complementamos las ecuaciones de conservación de momento con la ley constitutiva <span class="math inline">\(\sigma=0\)</span>, sin forzamento externo. Resultando así el sistema
<span class="math display">\[
\partial_t u+u\cdot Du = -Dp.
\]</span></p>
</div>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-138" class="example"><strong>Ejemplo 9.7  </strong></span>Las <strong>ecuaciones de Navier-Stokes</strong> resultan cuando complementamos las ecuaciones de conservación de momento con la ley constitutiva <span class="math inline">\(\sigma=\nu Du\)</span> donde <span class="math inline">\(\nu\)</span> es un coeficiente de viscosidad, sin forzamento externo. Resulta así el sistema
<span class="math display">\[
\partial_t u+u\cdot Du = -Dp + \nu\Delta u.
\]</span></p>
</div>
<p>Tanto en el sistema de ecuaciones de Euler como de Navier Stokes contamos con <span class="math inline">\(d\)</span> ecuaciones y <span class="math inline">\(d+1\)</span> incógnitas (<span class="math inline">\(u\)</span> y <span class="math inline">\(p\)</span>). Estas son usualmente complementadas de dos formas distintas:</p>
<ul>
<li><p>Para flujos incompresibles agregamos la ecuación <span class="math inline">\(\operatorname{div} u=0\)</span>.</p></li>
<li><p>Para flujos <strong>barotrópicos</strong> compresibles tenemos la ley de conservación de masa <span class="math inline">\(\partial_t \mu+\operatorname{div}(\mu u) = 0\)</span> y una ley de estado para la presión <span class="math inline">\(p=g(\mu)\)</span> de carácter termodinámico. La función <span class="math inline">\(g\)</span> es una función conocida que además es positiva, creciente y convexa.</p></li>
</ul>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-139" class="exercise"><strong>Ejercicio 9.9  </strong></span><strong>Ley de Bernoulli:</strong> Demuestra que si <span class="math inline">\(u\)</span> la ecuación de flujo estacionario
<span class="math display">\[
u\cdot Du = -Dp
\]</span>
entonces la energía total
<span class="math display">\[
E = \frac{1}{2}|u|^2 + p
\]</span>
es constante a lo largo de las curvas integrales de <span class="math inline">\(u\)</span>, también conocidas como las líneas de corriente.</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-140" class="exercise"><strong>Ejercicio 9.10  </strong></span><strong>Teorema de circulación de Kelvin:</strong> Sea <span class="math inline">\(u\)</span> una solución de
<span class="math display">\[
\partial_t u + u \cdot Du = -Dp,
\]</span>
la familia de mapeos <span class="math inline">\(\phi_t\)</span> se corresponden con el flujo generado por <span class="math inline">\(u\)</span> y <span class="math inline">\(\gamma_t=\phi_t(\gamma)\)</span> donde <span class="math inline">\(\gamma:[0,1]\to \mathbb R^n\)</span> es una curva cerrada de clase <span class="math inline">\(C^1\)</span>. Demuestra que la circulación de <span class="math inline">\(u\)</span> alrededor de <span class="math inline">\(\gamma_t\)</span> es constante, es decir
<span class="math display">\[
\int_{\gamma_t} u(t) = \int_\gamma u(0).
\]</span></p>
</div>
<details>
<summary>
Solución
</summary>
</details>
</div>
<div id="teoría-cinética" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Teoría cinética<a href="leyes-de-conservación.html#teoría-cinética" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En el modelo propuesto por las <strong>ecuaciones de Boltzmann</strong> las partículas interactúan a pares por medio de colisiones y sin forzamento externo adicional
<span class="math display">\[
\partial_t \rho + v\cdot D_x\rho = Q(\rho).
\]</span>
El lado izquierdo representa el transporte inercial de la densidad de partículas <span class="math inline">\(\rho=\rho(x,v,t)\)</span>. El lado derecho es un término de reacción y representa la producción neta de partículas que resultan a partir de las colisiones: Sea <span class="math inline">\(k(v&#39;,v)\geq 0\)</span> la frecuencia con la que ocurre una transformación de la velocidad <span class="math inline">\(v&#39;\)</span> a la velocidad <span class="math inline">\(v\)</span> por una colisión. Es decir que
<span class="math display">\[
Q(\rho)(v) = \int_{\mathbb R^d} k(v&#39;,v)\rho(v&#39;)dv&#39; - \sigma(v)\rho(v), \qquad \sigma(v) = \int_{\mathbb R^d} k(v,v&#39;)dv&#39;.
\]</span>
Si asumimos que <span class="math inline">\(k\)</span> y <span class="math inline">\(\sigma\)</span> son independientes de <span class="math inline">\(\rho\)</span> conseguimos la <strong>ecuación de Boltzmann lineal</strong>.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-141" class="example"><strong>Ejemplo 9.8  </strong></span>La hipótesis de <strong>monocinética</strong>, quiere decir que las velocidades tienen norma constante (digamos <span class="math inline">\(c\)</span>). Bajo la condición de <strong>dispersión isotrópica</strong> tenemos que <span class="math inline">\(k\)</span> es constante y por lo tanto <span class="math inline">\(\sigma=k|\partial B_c|\)</span>. Llegamos así a la ecuación
<span class="math display">\[
\partial_t \rho + v\cdot D_x\rho = k\int_{\partial B_c} (\rho(v&#39;)-\rho(v))dv&#39;.
\]</span></p>
</div>
<hr />
<p>Para la ecuación de Boltzmann no lineal modelamos las transiciones para pares de velocidades, es decir dos partículas con velocidades <span class="math inline">\((v&#39;,v_*&#39;)\)</span> colisionan y como resultado de la interacción salen con velocidades <span class="math inline">\(v\)</span> y <span class="math inline">\(v_*\)</span>.</p>
<p>Dicha interacción está naturalmente restringida por las leyes de conservación de momento y energía, es decir que
<span class="math display">\[
v&#39;+v_*&#39;=v+v_*, \qquad |v&#39;|^2+|v_*&#39;|^2 = |v|^2+|v_*|^2.
\]</span>
Equivalentemente
<span class="math display">\[
r:= |v&#39;- w| = |v-w|, \qquad 2w := v+v_* = v&#39;+v_*&#39;
\]</span>
por lo que conseguimos parametrizar a las velocidades previas a la colisión <span class="math inline">\(v&#39;\)</span> y <span class="math inline">\(v_*&#39;\)</span>, usando adicionalmente un vector unitario <span class="math inline">\(\theta\)</span> el cual caracteriza la <strong>dispersión</strong> de la colisión
<span class="math display">\[
v&#39; = w+r\theta, \qquad v_*&#39;=w+r\theta.
\]</span></p>
<p>Las velocidades <span class="math inline">\(v&#39;\)</span> y <span class="math inline">\(v_*&#39;\)</span> aparecen con frecuencia proporcional a <span class="math inline">\(\rho(v&#39;)\rho(v_*&#39;)\)</span>, es decir que modelamos la tasa en la que ocurren colisiones de la forma <span class="math inline">\((v&#39;,v_*&#39;) \mapsto (v,v_*)\)</span> según
<span class="math display">\[
\rho(w+r\theta)\rho(w-r\theta)B(r,\theta)
\]</span>
Para algún núcleo <span class="math inline">\(B\geq0\)</span>. En conclusión
<span class="math display">\[
Q(\rho)(v) = \int_{\mathbb R^d}\int_{\partial B_1} (\rho(v&#39;)\rho(v_*&#39;)-\rho(v)\rho(v_*))B(w,\theta)d\theta dv_*.
\]</span>
modela la tasa de producción de partículas con velocidad <span class="math inline">\(v\)</span> dada la distribución de velocidades dada por <span class="math inline">\(\rho\)</span>.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-142" class="example"><strong>Ejemplo 9.9  </strong></span>Colisiones elásticas…</p>
</div>
</div>
<div id="la-jerarquía-de-bogoliubov-born-green-kirkwood-yvon" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> La jerarquía de Bogoliubov-Born-Green-Kirkwood-Yvon<a href="leyes-de-conservación.html#la-jerarquía-de-bogoliubov-born-green-kirkwood-yvon" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consideremos un gas con <span class="math inline">\(N\gg 1\)</span> partículas idénticas. La densidad <span class="math inline">\(\rho_1=\rho_1(x,v):\mathbb R^d\times\mathbb R^d\to \mathbb R\)</span> es la fracción de las <span class="math inline">\(N\)</span> partículas que esperamos encontrar en la configuración <span class="math inline">\((x,v)\)</span>. Como tal asumimos que <span class="math inline">\(\rho_1\)</span> es una distribución de probabilidad sobre <span class="math inline">\(\mathbb R^d\times\mathbb R^d\)</span> (<span class="math inline">\(\rho_1\geq0\)</span> y <span class="math inline">\(\int\rho_1dvdx=1\)</span>).</p>
<p>A partir de <span class="math inline">\(j\geq 2\)</span> tenemos <span class="math inline">\(\binom{N}{j}\)</span> formas distintas de escoger <span class="math inline">\(j\)</span> partículas de las <span class="math inline">\(N\)</span> posibles. Modelamos por medio de las densidades <span class="math inline">\(\rho_j=\rho_j(x_1,\ldots,x_j,v_1,\ldots,v_j)\)</span> la fracción de estas <span class="math inline">\(\binom{N}{j}\)</span> combinaciones que esperamos encontrar en la configuración <span class="math inline">\((x_1,\ldots,x_j,v_1,\ldots,v_j)\)</span>. Observemos que <span class="math inline">\(\rho_j\)</span> además de ser una distribución de probabilidad sobre <span class="math inline">\(\mathbb R^{dj}\times\mathbb R^{dj}\)</span> también debe satisfacer la siguiente relación de simetría: Para cualquier permutación <span class="math inline">\(\sigma:\{1,\ldots,j\}\longleftrightarrow \{1,\ldots,j\}\)</span>
<span class="math display">\[
\rho_j(x_{\sigma(1)},\ldots,x_{\sigma(j)},v_{\sigma(1)},\ldots,v_{\sigma(j)})=\rho_j(x_1,\ldots,x_j,v_1,\ldots,v_j).
\]</span></p>
<p>Una última relación de consistencia que debemos asumir en la colección de distribuciones es que para <span class="math inline">\(j&lt;k\leq N\)</span> se tiene que
<span class="math display">\[
\rho_j(x_1,\ldots,x_j,v_1,\ldots,v_j) = \int \rho_k(x_1,\ldots,x_k,v_1,\ldots,v_k)dv_{j+1}\ldots dv_kdx_{j+1}\ldots dx_k.
\]</span>
En particular, cada una de las distribuciones se pueden definir a partir de marginales de <span class="math inline">\(\rho_N\)</span>. Esta última distribución es la jerarquía más alta y describe la dinámica de todas las partículas.</p>
<p>Consideraremos que la dinámica de las <span class="math inline">\(N\)</span> partículas están dadas por dos tipos de fuerzas: Las externas que dependen solamente de la posición y las de interacciones que dependen de las posiciones relativas de las partículas
<span class="math display">\[
mx_j&#39;&#39; = f_j(x) = f_{ext}(x_j) + \sum_{k\neq j}f_{int}(x_k-x_j)
\]</span>
Tengamos en cuenta que <span class="math inline">\(\rho_N\)</span> satisface la ecuación de Liouville
<span class="math display">\[
m\partial_t \rho_N + mv\cdot D_x\rho_N + f\cdot D_v\rho_N = 0.
\]</span>
Pasaremos ahora a deducir las ecuaciones para <span class="math inline">\(\rho_j\)</span> tomando marginales de la ecuación anterior. Para esto usamos que
<span class="math display">\[
\iint mv_k\cdot D_{x_k}\rho_N + f_k\cdot D_{v_k}\rho_N dv_kdx_k = \iint \operatorname{div}_{x_k,v_k} ((mv_k,f_k)\rho_N)dv_kdx_k = 0.
\]</span>
Por lo tanto
<span class="math display">\[
\begin{aligned}
    m\partial_t \rho_j + mv\cdot D_x\rho_j + f\cdot D_v\rho_j &amp;= -\sum_{k=1}^j\sum_{l=j+1}^N \int  f_{int}(x_l-x_k) \cdot D_{v_k} \rho_Ndv_{j+1}\ldots dv_kdx_{j+1}\ldots dx_k,\\
    &amp;= -(N-j) \int \sum_{k=1}^j f_{int}(y-x_k) D_{v_k} \cdot  \rho_{j+1}(x,y,v,w) dydw,
\end{aligned}
\]</span>
donde <span class="math inline">\((x,y) = (x_1,\ldots,x_j,y) \in \mathbb R^{d(j+1)}\)</span> y de forma similar para <span class="math inline">\((v,w)= (v_1,\ldots,v_j,w) \in \mathbb R^{d(j+1)}\)</span>.</p>
<p>En el caso particular <span class="math inline">\(j=1\)</span> se tiene la ecuación de transporte para una partícula bajo el forzamento externo, con un término de reacción que modela las interacciones entre pares de partículas modeladas por <span class="math inline">\(\rho_2\)</span>
<span class="math display">\[
m\partial_t \rho_1 + mv\cdot D_x\rho_1 + f_{ext} \cdot D_v\rho_1 = -(N-1)\int f_{int}(y-x) \cdot D_v \rho_2(x,y,v,w) dydw,
\]</span></p>
</div>
</div>
<div id="ecuaciones-de-maxwell" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Ecuaciones de Maxwell<a href="leyes-de-conservación.html#ecuaciones-de-maxwell" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="distancia-de-wasserstein" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Distancia de Wasserstein<a href="leyes-de-conservación.html#distancia-de-wasserstein" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hemos visto que las leyes de conservación nos permiten extender dinámicas puntuales a modelos continuos. La noción de velocidad dada por <span class="math inline">\(v=x&#39;\)</span> encuentra así su generalización en la ecuación <span class="math inline">\(\partial_t\mu + \operatorname{div}(\mu v) = 0\)</span>. Para ser precisos, dado <span class="math inline">\(\mu:\mathbb R^n\times (a,b)\to \mathbb R\)</span> decimos que la familia de campos <span class="math inline">\(v:\mathbb R^n\times(a,b)\to\mathbb R^n\)</span> representa su velocidad si
<span class="math display">\[
\partial_t \mu + \operatorname{div}(\mu v) = 0.
\]</span>
Observemos que <span class="math inline">\(v\)</span> no está necesariamente definida de forma única, por ejemplo <span class="math inline">\(v\)</span> puede ser arbitraria fuera del soporte de <span class="math inline">\(\mu\)</span>. En general, si <span class="math inline">\(w\)</span> satisface <span class="math inline">\(\operatorname{div}(\mu w)=0\)</span>, entonces <span class="math inline">\((v+w)\)</span> también es una velocidad para <span class="math inline">\(\mu\)</span>. Otro ejemplo en tres dimensiones sucede si <span class="math inline">\(w=D\times z\)</span> donde el campo <span class="math inline">\(z\)</span> tiene soporte en una región de espacio tiempo donde <span class="math inline">\(v\)</span> es constante (en general podemos tomar el dual de la derivada exterior de una forma diferencial de co-dimensión dos).</p>
<p>Esto es consistente con la noción puntual que hemos aprendido en cálculo y EDOs si identificamos los puntos con distribuciones delta. Es decir que si <span class="math inline">\(\mu(t) = \delta_{x(t)}\)</span>, entonces su velocidad está dada por cualquier familia de campos <span class="math inline">\(v(t)\)</span> tales que <span class="math inline">\(v(x(t),t) = x&#39;(t)\)</span>.</p>
<p>Dado el campo <span class="math inline">\(v\)</span>, el flujo <span class="math inline">\(\phi\)</span> que este genera, y una densidad inicial <span class="math inline">\(\mu_0\)</span> obtenemos la curva de densidades <span class="math inline">\(\mu_t = (\phi_t)_\#\mu_0\)</span> para la cual <span class="math inline">\(v\)</span> es su velocidad.</p>
<hr />
<div class="example">
<p><span id="exm:unlabeled-div-143" class="example"><strong>Ejemplo 9.10  </strong></span>Si <span class="math inline">\(T:\mathbb R^n\to\mathbb R^n\)</span> es un mapeo y <span class="math inline">\(v(x)=T(x)-x\)</span> entonces <span class="math inline">\(\phi_t(x) = (1-t)x+tT(x)\)</span> y <span class="math inline">\(\mu_t(x) = (\phi_t)_\#\mu_0\)</span> puede verse como una interpolación horizontal entre <span class="math inline">\(\mu_0\)</span> y <span class="math inline">\(\mu_1 = T_\#\mu_0\)</span>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-144" class="exercise"><strong>Ejercicio 9.11  </strong></span>Calcula una velocidad de las siguientes curvas de Gaussianas en <span class="math inline">\(\mathbb R^n\)</span> en función de <span class="math inline">\(m:\mathbb R\to\mathbb R^n\)</span> y <span class="math inline">\(\sigma:\mathbb R\to(0,\infty)\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\mu(x,t) := \exp(-|x-m(t)|^2)\)</span>.</p></li>
<li><p><span class="math inline">\(\mu(x,t) := \sigma(t)^{-n}\exp(-|x|^2/\sigma(t)^2)\)</span>.</p></li>
<li><p><span class="math inline">\(\mu(x,t) := \sigma(t)^{-n}\exp(-(|x-m(t)|^2/\sigma(t)^2)\)</span>.</p></li>
</ol>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<p>Así como tenemos una noción de velocidad, podemos ahora definir la energía cinética para una curva de distribuciones. Es decir que para <span class="math inline">\(\mu:\mathbb R^n\times [0,1]\to \mathbb R\)</span>
<span class="math display">\[
K[\mu] = \frac{1}{2}\int_0^1 \int_{\mathbb R^n} \mu|v|^2 dx dt
\]</span></p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-145" class="exercise"><strong>Ejercicio 9.12  </strong></span>Calcula la energía cinética para cada una de las Gaussianas en el ejercicio anterior, en el intervalo <span class="math inline">\([0,1]\)</span>.</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<p>A partir de la energía cinética podemos definir las curvas geodésicas a partir de un problema de minimización. Dadas dos distribuciones <span class="math inline">\(\mu_0\)</span> y <span class="math inline">\(\mu_1\)</span> tales que <span class="math inline">\(\int_{\mathbb R^n}\mu_0dx=\int_{\mathbb R^n}\mu_1dx&lt;\infty\)</span>, la idea es dar con una curva que minimice la energía cinética con las restricciones <span class="math inline">\(\mu(0)=\mu_0\)</span> y <span class="math inline">\(\mu(1)=\mu_1\)</span>. La condición en las integrales es necesaria puesto que la ley de conservación preserva la masa.</p>
<p>A partir de esta construcción definimos la <strong>métrica de Wasserstein</strong>
<span class="math display">\[
\mathcal W^2(\mu_0,\mu_1) := \inf\left\{ \int_0^1 \int_{\mathbb R^n} \mu|v|^2dxdt \ | \ \mu(0)=\mu_0, \mu(1)=\mu_1, \partial_t\mu+\operatorname{div}(\mu v) = 0\right\}.
\]</span></p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-146" class="exercise"><strong>Ejercicio 9.13  </strong></span>Sea <span class="math inline">\(\mu:\mathbb R^n\times[0,1]\to\mathbb R\)</span> una curva de distribuciones, <span class="math inline">\(\phi:\mathbb R^n\times[0,1]\to\mathbb R^n\)</span> un flujo generado por la velocidad <span class="math inline">\(v\)</span> para <span class="math inline">\(\mu\)</span>, y sea <span class="math inline">\(\bar\phi_t(x) := (1-t)x+t\phi_1(x)\)</span>. Demuestra que para <span class="math inline">\(\bar\mu := (\bar\phi_t)_\#\mu_0\)</span>, cuya velocidad es <span class="math inline">\(\bar v(x) := \phi_1(x)-x\)</span> se tiene que
<span class="math display">\[
\int_0^1\int_{\mathbb R^n} \mu|v|^2dxdt \geq \int_0^1\int_{\mathbb R^n} \bar\mu|\bar v|^2dxdt = \int_{\mathbb R^n} |\phi_1(x)-x|^2dx
\]</span></p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<p>El ejercicio anterior es el análogo a decir que los segmentos rectos recorridos de forma uniforme disminuyen la energía cinética (Figura <a href="leyes-de-conservación.html#fig:seg">9.3</a>.</p>
<div class="figure"><span style="display:block;" id="fig:seg"></span>
<img src="seg.png" style="width:70.0%" alt="" />
<p class="caption">Figura 9.3:  Transporte por segmentos</p>
</div>
<p>El problema que consiste en minimizar el costo cuadrático <span class="math inline">\(\int_{\mathbb R^n} |T(x)-x|^2dx\)</span>, sobre todas los mapeos <span class="math inline">\(T\)</span> que mandan a <span class="math inline">\(\mu_0\)</span> en <span class="math inline">\(\mu_1\)</span> se conoce como el problema de <strong>transporte óptimo cuadrático</strong>.</p>
<p>Es conocido que que bajo ciertas hipótesis <span class="math inline">\(T=Du\)</span> para una función convexa <span class="math inline">\(u\)</span> que satisface la ecuación de Monge-Ampère
<span class="math display">\[
\det D^2u = \frac{\mu_0}{\mu_1\circ T}
\]</span></p>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-147" class="exercise"><strong>Ejercicio 9.14  </strong></span>Calcula <span class="math inline">\(\mathcal W^2(\mu_0,\mu_1)\)</span> para las siguientes distribuciones en <span class="math inline">\(\mathbb R^2\)</span>
<span class="math display">\[
\mu_0=\delta_{(0,0)}+\delta_{(0,1)}, \qquad \mu_1=\delta_{(1,0)}+\delta_{(1,1)}.
\]</span>
¿Puedes generalizar este resultado para un número arbitrario de puntos?</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-148" class="exercise"><strong>Ejercicio 9.15  </strong></span>Calcula <span class="math inline">\(\mathcal W^2(\mu_0,\mu_1)\)</span> para las siguientes distribuciones en <span class="math inline">\(\mathbb R\)</span>
<span class="math display">\[
\mu_0=\chi_{(0,2)}, \qquad \mu_1=\chi_{(1,3)}.
\]</span>
¿Puedes generalizar este resultado para distribuciones arbitrarias en <span class="math inline">\(\mathbb R\)</span>?</p>
</div>
<details>
<summary>
Solución
</summary>
</details>
<hr />
<div class="exercise">
<p><span id="exr:unlabeled-div-149" class="exercise"><strong>Ejercicio 9.16  </strong></span>Calcula <span class="math inline">\(\mathcal W^2(\mu_0,\mu_1)\)</span> para las siguientes distribuciones en <span class="math inline">\(\mathbb R^n\)</span></p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\mu_0(x) = \exp(-|x-m_0|^2)\)</span>, <span class="math inline">\(\mu_1(x) = \exp(-|x-m_1|^2)\)</span>.</p></li>
<li><p><span class="math inline">\(\mu_0(x) = \sigma_0^{-n}\exp(-|x|^2/\sigma_0^2)\)</span>, <span class="math inline">\(\mu_1(x) = \sigma_1^{-n}\exp(-|x|^2/\sigma_1^2)\)</span>.</p></li>
<li><p><span class="math inline">\(\mu_0(x) = \sigma_0^{-n}\exp(-|x-m_0|^2/\sigma_0^2)\)</span>, <span class="math inline">\(\mu_1(x) = \sigma_1^{-n}\exp(-|x-m_1|^2/\sigma_1^2)\)</span>.</p></li>
</ol>
</div>
<details>
<summary>
Solución
</summary>
</details>

</div>
</div>































<div class="footnotes">
<hr />
<ol start="17">
<li id="fn17"><p>En inglés se distinguen dos nociones de <em>flujo</em>. <em>Flow</em> se traduce como el flujo <span class="math inline">\(\phi\)</span> dado por la familia de mapeos generados por el campo <span class="math inline">\(v\)</span>. <em>Flux</em> también se traduce como flujo pero se refiere a la cantidad de masa que está atravesando una región en una dirección dada.<a href="leyes-de-conservación.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>Push-foward<a href="leyes-de-conservación.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Este caso es ligeramente distinto puesto que <span class="math inline">\(\rho\)</span> es la distribución de posiciones y momento, no velocidades.<a href="leyes-de-conservación.html#fnref19" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cantidades-conservadas.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/09-leyes_de_conservacion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/hchanglara/metodos_mat_aplicadas/blob/master/09-leyes_de_conservacion.Rmd",
"text": null
},
"download": ["bookdown_intro.pdf", "bookdown_intro.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
