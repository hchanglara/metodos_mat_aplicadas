[["index.html", "Métodos de matemáticas aplicadas Prefacio", " Métodos de matemáticas aplicadas Héctor Andrés Chang-Lara 2022-07-18 Prefacio Hola "],["entramados.html", "Capítulo 1 Entramados", " Capítulo 1 Entramados La siguiente figura ilustra cuatro puntos masivos unidos por tres barras de longitudes conocidas \\(\\ell_{01}, \\ell_{12}, \\ell_{23}\\), y masas despreciables. Los extremos etiquetados por \\(0\\) y \\(3\\) tienen posiciones fijas y los nodos intermedios de masas \\(m_1\\) y \\(m_2\\) ocupan posiciones de equilibrio. ¿A partir de cuales ecuaciones se podrían determinar las posiciones \\(q_i=(x_i,y_i)\\) de estos nodos? Antes de proceder a plantear el sistema de ecuaciones recordemos que por lo general el número de ecuaciones e incógnitas deben ser iguales para que este esté bien planteado, es decir que existan soluciones y que sean únicas (al menos localmente). En nuestro caso tenemos cuatro incógnitas, los dos pares de coordenadas de cada nodo libre. Además debemos considerar las restricciones impuestas por las distancias entre los nodos, es decir tres ecuaciones. Hasta el momento el sistema es indeterminado, tiene más incógnitas (4) que ecuaciones (3), sin embargo aún nos falta incorporar la información del fenómeno de equilibrio. \\[ \\begin{cases} (x_1-0)^2 + (y_1-0)^2 = \\ell_{01}^2\\\\ (x_1-x_2)^2 + (y_1-y_2)^2 = \\ell_{12}^2\\\\ (x_2-3)^2 + (y_2-0)^2 = \\ell_{23}^2 \\end{cases} \\] En cada nodo libre actúan tres fuerzas: dos tensiones y la gravedad \\((= -m_ige_y)\\). Por ejemplo, la tensión \\(T_{12}\\) sobre el nodo 1 y que se produce sobre el segmento que une los nodos 1 y 2 es proporcional al vector \\(q_2-q_1\\), es decir \\(T_{12} = \\lambda_{12} (q_2-q_1)\\) para un cierto escalar \\(\\lambda_{12}\\). Similarmente podemos razonar sobre las demás interacciones, introduciendo así cuatro nuevas variables \\(\\lambda_{10}, \\lambda_{12}, \\lambda_{21}\\), y \\(\\lambda_{23}\\). Para que el sistema se encuentre en equilibrio, la suma de las fuerzas sobre cada nodo debe anularse, lo cual nos da igualmente cuatro ecuaciones: \\[ \\begin{cases} \\lambda_{10}(x_{0}-x_{1})+\\lambda_{12}(x_{2}-x_{1}) = 0\\\\ \\lambda_{10}(y_{0}-y_{1})+\\lambda_{12}(y_{2}-y_{1}) = m_{1}g\\\\ \\lambda_{23}(x_{3}-x_{2})+\\lambda_{21}(x_{1}-x_{2}) = 0\\\\ \\lambda_{23}(y_{3}-y_{2})+\\lambda_{21}(y_{1}-y_{2}) = m_{2}g \\end{cases} \\] Pareciera que no hemos logrado mucho en términos del sistema que sigue siendo indeterminado con ocho incógnitas (2 \\(x\\)’s, 2 \\(y\\)’s y 4 \\(\\lambda\\)’s) y siete ecuaciones (3 distancias y 4 balances de fuerzas). Sin embargo, la tercera ley de Newton nos dice que las interacciones entre pares de nodos guarda una simetría: toda acción produce una reacción opuesta de la misma magnitud. En nuestro modelo esto se refleja en \\(T_{12} = -T_{21}\\), de donde obtenemos la última ecuación \\[ \\lambda_{12}=\\lambda_{21}. \\] De hecho es más sencillo eliminar una de las incógnitas (\\(\\lambda_{21}\\)) que añadir otra ecuación. En conclusión obtenemos el siguiente sistema con siete ecuaciones e incógnitas \\[ \\begin{cases} \\lambda_{10}(x_{0}-x_{1})+\\lambda_{12}(x_{2}-x_{1}) = 0\\\\ \\lambda_{10}(y_{0}-y_{1})+\\lambda_{12}(y_{2}-y_{1}) = m_{1}g\\\\ \\lambda_{23}(x_{3}-x_{2})+\\lambda_{12}(x_{1}-x_{2}) = 0\\\\ \\lambda_{23}(y_{3}-y_{2})+\\lambda_{12}(y_{1}-y_{2}) = m_{2}g\\\\ (x_1-0)^2 + (y_1-0)^2 = \\ell_{01}^2\\\\ (x_1-x_2)^2 + (y_1-y_2)^2 = \\ell_{12}^2\\\\ (x_2-3)^2 + (y_2-0)^2 = \\ell_{23}^2 \\end{cases} \\] Una forma de obtener solución a este sistema es el método de Newton. Por ejemplo, para los valores \\(\\ell_{01}=\\sqrt{5}, \\ell_{12}=\\sqrt{5}, \\ell_{23}=\\sqrt{10}, m_1=1, m_2=2, q_0=(0,0), q_3=(4,0)\\) la siguiente implementación ilustra como obtener la solución usando Python1. #Librerías import matplotlib.pyplot as plt import numpy as np from scipy.optimize import fsolve #Parámetros l01=np.sqrt(5) l12=np.sqrt(5) l23=np.sqrt(10) x3,y3=4,0 m1=1 m2=2 #Sistema de ecuaciones y gráfica def f(x): x1,y1,x2,y2,lambda01,lambda12,lambda23 = x f=np.zeros(7) f[0] = x1**2+y1**2-l01**2 f[1] = (x2-x1)**2+(y2-y1)**2-l12**2 f[2] = (x3-x2)**2+(y3-y2)**2-l23**2 f[3] = -lambda01*x1+lambda12*(x2-x1) f[4] = -lambda01*y1+lambda12*(y2-y1)-m1 f[5] = lambda12*(x1-x2)+lambda23*(x3-x2) f[6] = lambda12*(y1-y2)+lambda23*(y3-y2)-m2 return f r = fsolve(f,[1,-1,3,-2,0,0,0]) x1,y1=r[0],r[1] x2,y2=r[2],r[3] fig, ax = plt.subplots() ax.plot([0,r[0],r[2],x3], [0,r[1],r[3],y3]) ax.plot(0,0,color=&#39;tab:blue&#39;, marker=&#39;o&#39;, label=&#39;$q_0=(0,0)$&#39;) ax.plot(x1,y1,color=&#39;tab:orange&#39;, marker=&#39;o&#39;, label=&quot;$q_1=({:.4f},{:.4f})$&quot;.format(x1, y1)) ax.plot(x2,y2,color=&#39;tab:green&#39;, marker=&#39;o&#39;, label=&quot;$q_1=({:.4f},{:.4f})$&quot;.format(x2, y2)) ax.plot(x3,y3,color=&#39;tab:red&#39;, marker=&#39;o&#39;, label=&quot;$q_1=({},{})$&quot;.format(x3, y3)) leg = ax.legend(); plt.show() Estas ideas son fácilmente generalizables a configuraciones lineales con más nodos. En el límite se obtiene el problema de la catenaria. También podemos considerar estructuras más complejas, por ejemplo un pañuelo sujeto por las esquinas. Para poder dar una generalización de estos modelos presentamos en la siguiente sección algunas nociones básicas de teoría de grafos. Una referencia entretenida con aplicaciones en arquitectura está en el siguiente enlace: Diseñar estructuras… ¿sin cálculos?  La magia de la CATENARIA Ejercicio 1.1 Calcula \\(m_2\\) para que el entramado esté en equilibrio dado que los nodos en \\((0,0)\\) y \\((13,0)\\) están fijos Solución Las fuerzas en el nodo \\(1\\) están dadas por \\[ \\begin{cases} 5\\lambda_{01}=6\\lambda_{12},\\\\ 8\\lambda_{01}+\\lambda_{12}=g \\end{cases} \\qquad\\Rightarrow\\qquad \\lambda_{01}=\\frac{6g}{53}, \\lambda_{12}=\\frac{5g}{53} \\] Las fuerzas en el nodo \\(2\\) están dadas por \\[ \\begin{cases} 6\\lambda_{12}=2\\lambda_{23},\\\\ -\\lambda_{12}+7\\lambda_{23}=m_2g \\end{cases} \\qquad\\Rightarrow\\qquad \\lambda_{23}=\\frac{15g}{53}, m_2=\\frac{100}{53}. \\] Ejercicio 1.2 Demuestra que si un dado entramado como en la figura, y con extremos en el eje horizontal, está en equilibro, entonces su correspondiente reflexión en el eje horizontal también está en equilibrio. ¿Será posible generalizar este principio a un entramado general? Solución Denotamos por \\(\\lambda_i=\\lambda_{i,i-1} = -\\lambda_{i-1,i}\\). En cada nodo del entramado original se tiene el balance de fuerzas está dado por \\[ \\begin{cases} (x_i-x_{i-1})\\lambda_i=(x_{i+1}-x_{i})\\lambda_{i+1},\\\\ (y_{i-1}-y_{i})\\lambda_i+(y_{i+1}-y_{i})\\lambda_{i+1}=m_ig \\end{cases} \\] Al tomar la reflexión en el eje horizontal las coordenadas de los nodos pasan a ser \\((x_i,y_i)\\mapsto (x_i&#39;,y_i&#39;) = (x_i,-y_i)\\). Gracias a las relaciones previas, se observa que estas coordenadas satisfacen igualmente las ecuaciones de balance de fuerzas cuando igualmente reemplazamos \\(\\lambda_i\\mapsto \\lambda_i&#39; =-\\lambda_i\\) \\[ \\begin{cases} (x_i&#39;-x_{i-1}&#39;)\\lambda_i&#39;=(x_{i+1}&#39;-x_{i}&#39;)\\lambda_{i+1}&#39;,\\\\ (y_{i-1}&#39;-y_{i}&#39;)\\lambda_i&#39;+(y_{i+1}&#39;-y_{i}&#39;)\\lambda_{i+1}&#39;=m_ig. \\end{cases} \\] Este principio se generaliza a un entramado general con una notación adecuada. Advertencia: El código es sensible a las condiciones iniciales para la iteración y no siempre converge.↩︎ "],["hello-bookdown.html", "Capítulo 2 Hello bookdown 2.1 A section", " Capítulo 2 Hello bookdown All chapters start with a first-level heading followed by your chapter title, like the line above. There should be only one first-level heading (#) per .Rmd file. 2.1 A section All chapter sections start with a second-level (##) or higher heading followed by your section title, like the sections above and below here. You can have as many as you want within a chapter. An unnumbered section Chapters and sections are numbered by default. To un-number a heading, add a {.unnumbered} or the shorter {-} at the end of the heading, like in this section. "],["cálculo-discreto.html", "Capítulo 3 Cálculo discreto 3.1 Gradiente 3.2 Divergencia 3.3 Integración por partes 3.4 Laplaciano", " Capítulo 3 Cálculo discreto Una grafo dirigido \\(G = (V,E)\\) consiste de un conjunto de vértices \\(V\\), también llamados nodos, y un conjunto de aristas \\(E \\subseteq V^2\\), es decir pares ordenados de \\(V\\). Definición 3.1 Dado \\(e = (a,b)\\in E\\), denotamos por \\(e_-=a\\) y \\(e_+=b\\) los nodos de partida y llegada de \\(e\\) respectivamente y decimos que \\(e\\) está orientado de \\(a\\) a \\(b\\). En general trabajaremos con grafos con aristas simples, es decir que a lo sumo existe una arista que conecta dos vértices en cualquier orientación. Sin embargo, cuando \\(e=(a,b)\\in E\\) podríamos hacer referencia a la arista \\(-e=(b,a)\\) como la arista \\(e\\) con el sentido opuesto. Finalmente, podemos considerar también conjuntos de aristas no orientadas en cuyo caso decimos que el grafo es no dirigido. Ejercicio 3.1 Dibuja el grafo \\(G=(V,E)\\) para \\[ V = \\{1,2,3,a,b,c\\}, \\qquad E = \\{(1,a),(1,b),(1,c),(2,a),(2,b),(2,c),(3,a),(3,b),(3,c)\\}. \\] Solución Las redes eléctricas son uno de los modelos más conocidos que se pueden formular en términos de grafos. Sobre el grafo podemos caracterizar por ejemplo el potencial o voltaje como una función \\(u:V\\to \\mathbb R\\) y la corriente como una función \\(i:E\\to \\mathbb R\\). Siguiendo un poco la nomenclatura que sugiere este modelo, distinguimos dos tipos de funciones en \\(G\\): Potencial: Es una función sobre el conjunto de vértices \\(u: V \\to \\mathbb R\\). Flujo: Es una función sobre el conjunto de aristas \\(i: E \\to \\mathbb R\\). En algunos casos también podríamos considerar que dichas funciones tomen valores en \\(\\mathbb C\\), \\(\\mathbb R^n\\) ó \\(\\mathbb C^n\\). Cuando \\(G\\) es un grafo dirigido, decimos que \\(i:E\\to\\mathbb R\\) es par cuando no depende de la orientación \\(i(-e) = i(e)\\), y decimos que impar si en cambio \\(i(-e) = -i(e)\\). Una función \\(i:E\\to\\mathbb R\\) en un grafo no dirigido es equivalente a una función par en el mismo grafo y con cualquier orientación sobre las aristas. Ejemplo 3.1 En el modelo de entramados en la sección anterior, el grafo no dirigido \\(G=(V,E)\\) con \\(V = \\{0,1,2,3\\}\\) y \\(E=\\{\\{0,1\\},\\{1,2\\},\\{2,3\\}\\}\\) nos proporciona la información sobre cuales nodos están conectados entre si. Las posiciones de los nodos se caracterizan por \\(q:V\\to \\mathbb R^2\\) y las longitudes de los enlaces están determinadas por \\(\\ell:E\\to\\mathbb R\\). Para modelar las tensiones es conveniente considerar el grafo dirigido \\(G=(V,E&#39;)\\) de alguna forma arbitraria, quizás \\(E&#39;=\\{(0,1),(1,2),(2,3)\\}\\). De esta forma contamos con la función par \\(\\lambda:E&#39;\\to\\mathbb R\\) y la función impar \\(T: E&#39; \\to \\mathbb R^2\\) tales que \\[ T(e) = \\lambda(e)(q(e_+)-q(e_-)) \\] es la tensión sobre el nodo \\(e_-\\) a lo largo de \\(e\\). A su vez y gracias a la ley de acción y reacción, \\(T(-e) = -T(e)\\) es la tensión sobre el nodo \\(e_+\\) a lo largo de \\(e\\) pero en la orientación opuesta, es decir \\(-e\\). Ejemplo 3.2 Un potencial \\(u:V\\to\\mathbb R\\) sobre una red de resistencia genera una corriente \\(i:E\\to \\mathbb R\\) que modelamos usando la ley de Ohm para una dada resistencia \\(R:E\\to (0,\\infty)\\) (función par). Esto quiere decir que la corriente \\(i(e)\\) que atraviesa una arista \\(e = (e_-,e_+)\\) es proporcional a la diferencia de los potenciales en los extremos de la arista \\[ i(e) = \\frac{u(e_+) - u(e_-)}{R(e)}, \\qquad R(e) &gt;0: \\text{ Resistencia.} \\] 3.1 Gradiente Tanto en la construcción de las tensiones \\(T\\), como en la de la corriente eléctrica \\(i\\), estamos considerando la variación de una dada función (las posiciones \\(q\\) ó el potencial \\(u\\)) a lo largo de una arista dada. Esto es una versión discreta de la derivada direccional. En este caso requerimos que el grafo sea orientado. Definición 3.2 Dado potencial \\(u:V\\to\\mathbb R\\) sobre un grafo dirigido \\(G=(V,E)\\), definimos el gradiente \\(Du: E \\to \\mathbb R\\) tal que \\[ Du(e) = u(e_{+})-u(e_{-}). \\] En particular, el gradiente es una función impar. Ejemplo 3.3 En la siguiente figura se calculó el gradiente de la función dada en los vértices Ejercicio 3.2 Verifica que el gradiente satisface la identidad de Leibniz \\[ D(u_1u_2) = u_1^+ Du_2 + u_2^-Du_1 \\] donde \\(u^\\pm:E\\to\\mathbb R\\) se define a partir de \\(u:V\\to\\mathbb R\\) como \\(u^\\pm(e) = u(e_\\pm)\\). Solución \\[ \\begin{aligned} D(u_1u_2)(e) &amp;= u_1(e_+)u_2(e_+) - u_1(e_-)u_2(e_-),\\\\ &amp;= u_1(e_+)u_2(e_+) - u_1(e_+)u_2(e_-) + u_1(e_+)u_2(e_-) - u_1(e_-)u_2(e_-),\\\\ &amp;= u_1(e_+)(u_2(e_+)-u_2(e_-)) + u_2(e_-)(u_1(e_+)-u_1(e_-)),\\\\ &amp;= u_1(e_+)Du_2(e) + u_2(e_-)Du_1(e),\\\\ &amp;= (u_1^+Du_2 + u_2^-Du_1)(e). \\end{aligned} \\] 3.1.1 Ley de ciclos No toda función \\(i:E\\to \\mathbb R\\) es necesariamente un gradiente. Una condición necesaria y suficiente es la ley de ciclos. Para poder enunciar esta ley es conveniente dar algunas definiciones previas para un dado grafo dirigido \\(G=(V,E)\\). Definición 3.3 Un camino no orientado es una sucesión de vértices \\(x_0,x_1, \\dots, x_n \\in V\\) tal que \\((x_j,x_{j+1})\\) o \\((x_{j+1},x_{j})\\) es una arista en \\(E\\) para todo \\(j\\in\\{0,1,\\ldots,(n-1)\\}\\). Se dice que el camino es un ciclo si además \\(x_n=x_0\\). Definición 3.4 Una componente conexa de \\(G\\) es un subconjunto \\(V&#39;\\subseteq V\\) tal que: Todos los vértices en \\(V&#39;\\) están conectados entre si por algún camino. Ningún vértice de \\(V&#39;\\) está conectado con ningún vértice de \\(V\\setminus V&#39;\\). Decimos que \\(G\\) es conexo si tiene una única componente conexa. Teorema 3.1 (Ley de ciclos) Sea \\(G=(V,E)\\) un grafo dirigido finito. Una función impar \\(i:E\\to\\mathbb R\\) es igual al gradiente de una función \\(u:V\\to \\mathbb R\\) si y solo si para todo ciclo \\(x_0,x_1, \\dots, x_n=x_0\\) se tiene que \\[ \\sum_{j=0}^{n-1} i(x_j,x_{j+1}) = 0. \\] Demostración. Por un lado es fácil verificar la identidad para flujos gradientes usando la propiedad telescópica. Dado un ciclo \\(x_0,x_1, \\dots, x_n=x_0\\) \\[ \\sum_{j=0}^{n-1} Du(x_j,x_{j+1}) = \\sum_{j=0}^{n-1} (u(x_{j+1})-u(x_j)) = u(x_n)-u(x_0)=0. \\] Podemos construir \\(u:V&#39;\\to \\mathbb R\\) sobre cada una de las componentes conexa de \\(G\\) de la siguiente forma. Fijemos \\(x_0 \\in V&#39;\\) y definimos \\[ u(x) := \\sum_{j=0}^{n-1} i(x_j,x_{j+1}) \\] donde \\(x_0,x_1, \\dots, x_n=x\\) es un camino no orientado que conecta \\(x_0\\) con \\(x\\in V&#39;\\). La hipótesis dada por la ley de ciclos garantiza que esta construcción no depende del camino escogido, es decir que está bien definida sin posible ambigüedad: Dados dos caminos \\(x_0,\\ldots,x_n=x\\) y \\(y_0=x_0,\\ldots,y_m=x\\) se tiene que \\(z_0=x_0,\\ldots,z_n=x_n,z_{n+1}=y_{m-1},\\ldots,z_{n+m}=y_0\\) es un ciclo y por lo tanto \\[ 0 = \\sum_{j=0}^{n+m-1} i(z_j,z_{j+1}) = \\sum_{j=0}^{n-1} i(x_j,x_{j+1}) - \\sum_{j=0}^{m-1} i(y_j,y_{j+1}). \\] Veamos finalmente que \\(Du = i\\). Dado \\(e=(a,b)\\) con \\(a\\) y \\(b\\) en la misma componente que \\(x_0\\), tomamos un camino \\(x_0,x_1,\\ldots, x_n=a\\) de \\(x_0\\) a \\(a\\) y luego añadimos \\(x_{n+1}=b\\) para formar un camino de \\(x_0\\) a \\(b\\). Por lo tanto \\[ Du(e) = u(b)-u(a) = \\sum_{j=0}^{n} i(x_j,x_{j+1})-\\sum_{j=0}^{n-1} i(x_j,x_{j+1}) = i(a,b), \\] con lo cual concluímos la demostración. Este argumento nos permite apreciar que \\(u\\) está únicamente determinado salvo potenciales constantes en cada componente conexa de \\(G\\). Las constantes son los valores arbitrarios que daríamos a \\(u\\) sobre el nodo \\(x_0\\), que en nuestra demostración fue cero. Ejercicio 3.3 Calcula los potenciales que generan el flujo dado en la siguiente figura Solución El flujo satisface la ley de ciclos. Por ejemplo en el triángulo de la izquierda la suma correspondiente es \\(-3+1+2=0\\) y de igual forma podemos verificar en el triángulo de la derecha (\\(2+(-1)+(-1)=0\\)) o en el cuadrado exterior (\\((-3)+1-(-1)-(-1)=0\\)). Si tomamos \\(u(A)=0\\) sin pérdida de generalidad tenemos que \\[ \\begin{cases} u(B) = 1 + u(A) = 1,\\\\ u(C) = 3 + u(A) = 3,\\\\ u(D) = -1 + u(C) = 2. \\end{cases} \\] Verificamos además que con estos valores se obtiene el gradiente prescrito \\[ \\begin{cases} Du(AB) = u(B)-u(A) = 1-0 = 1,\\\\ Du(BC) = u(C)-u(B) = 3-1 = 2,\\\\ Du(CA) = u(A)-u(C) = 0-3 = -3,\\\\ Du(CD) = u(D)-u(C) = 2-3 = -1,\\\\ Du(DB) = u(B)-u(D) = 1-2 = -1. \\end{cases} \\] En general, \\(u\\) tiene el gradiente prescrito si y solo si \\[ u(A) = C, \\qquad u(B) = 1+C, \\qquad u(C) = 3+C, \\qquad u(D)=2+C. \\] Margen de cálculo: El lema de Poincaré Como ya el lector habrá notado, estas construcciones y propiedades encuentran paralelos en cálculo multivariable, y de hecho las demostraciones reproducen las mismas ideas: Los caminos son curvas, los ciclos son lazos o curvas cerradas y la expresión \\(\\sum_{j=0}^{n-1} i(x_j,x_{j+1})\\) es análoga a la integral de línea o el trabajo de un campo vectorial sobre una curva. El resultado que acabamos de enunciar se conoce como el Lema de Poincaré global. Recordemos su enunciado junto con el resultado local. Lema de Poincaré (global): Un campo vectorial \\(v \\in C(\\Omega\\subseteq\\mathbb R^n\\to\\mathbb R^n)\\) es el gradiente de algún potencial \\(u\\in C^1(\\Omega\\to\\mathbb R)\\) si y sólo si para cualquier curva cerrada \\(\\gamma \\in C^1([a,b]\\to\\Omega)\\) (i.e. \\(\\gamma(b)=\\gamma(a)\\)) se tiene que el trabajo que ejerce \\(v\\) sobre la curva \\(\\gamma\\) se anula \\[ \\int_\\gamma v = \\int_a^b v(\\gamma(t))\\cdot \\gamma&#39;(t)dt = 0. \\] Lema de Poincaré (local): Si \\(\\Omega\\subseteq\\mathbb R^n\\) es simplemente conexo2 entonces \\(v \\in C^1(\\Omega\\to\\mathbb R^n)\\) es un gradiente si y solo si \\(\\partial_iv_j = \\partial_jv_i\\). 3.2 Divergencia Otro operador diferencial que tiene su análogo en grafos es la divergencia. Heurísticamente, la divergencia de un campo vectorial mide la producción/absorción de masa a partir de un flujo. Definición 3.5 Dado \\(i: E \\to \\mathbb R\\) denotamos por \\(\\operatorname{div} i:V\\to \\mathbb R\\) a la divergencia de \\(i\\) donde \\[ \\operatorname{div} i(v) = \\sum_{e_-=v}i(e)-\\sum_{e_+=v}i(e) \\] Ejemplo 3.4 En la siguiente figura se calculó la divergencia de la función dada en las aristas Ejemplo 3.5 Las ecuaciones de balance para un entramado se escriben en términos de la divergencia de las tensiones sobre los nodos libres como \\[ \\operatorname{div} T = -mge_y \\] Ejemplo 3.6 La ley de Kirchhoff dice que en en un nodo que no está conectado a la batería, la corriente que entra y sale de este son iguales. En términos de la divergencia quiere decir que \\[ \\operatorname{div} i = 0 \\] 3.2.1 Ley de conservación Al igual que antes, podríamos preguntarnos si todo potencial es la divergencia de algún campo. Esto no es necesariamente cierto, la divergencia satisface la ley de conservación, análoga al teorema de la divergencia. Un caso particular ilustrativo de esta ley postula que la suma de la divergencia sobre un grafo finito es igual a cero \\[ \\sum_{v\\in V} \\operatorname{div} i(v) = 0. \\] Una vez más la justificación se basa en una propiedad telescópica para la suma: Cada arista aparece dos veces en la suma con signos opuestos dependiendo si se considera su vértice origen o de llegada. Para dar una versión discreta del teorema de la divergencia consideramos el campo normal exterior \\(n_\\Omega:E\\to \\mathbb R\\) tal que \\[ n_\\Omega(e) = \\begin{cases} +1 \\text{ si $e_-\\in \\Omega$ y $e_+\\in V\\setminus \\Omega$},\\\\ -1 \\text{ si $e_-\\in V\\setminus \\Omega$ y $e_+\\in \\Omega$},\\\\ 0 \\text{ en cualquier otro caso} \\end{cases} \\] en este caso el signo de \\(n_\\Omega(e)\\) indica cuando la arista orientada conecta a \\(\\Omega\\) con su complemento o viceversa. Ejercicio 3.4 El campo normal es el gradiente de una dada función ¿Cuál?. Solución \\(n_\\Omega = D1_{V\\setminus \\Omega}\\) donde \\[ 1_{V\\setminus \\Omega}(x) = \\begin{cases} 1 \\text{ si } x\\in V\\setminus \\Omega,\\\\ 0 \\text{ en cualquier otro caso}. \\end{cases} \\] Teorema 3.2 (Ley de conservación) Sea \\(G=(V,E)\\) un grafo dirigido finito. La divergencia de \\(i:E\\to \\mathbb R\\) verifica \\[ \\sum_{v\\in \\Omega} \\operatorname{div} i(v) = \\sum_{e\\in E} i(e)n_\\Omega(e) \\] De hecho la suma en el lado derecho ocurre en realidad sobre un subconjunto de aristas que podemos definir como el borde de \\(\\partial\\Omega\\) \\[ \\partial \\Omega := \\{e\\in E\\ | \\ \\{e_+,e_-\\} \\cap \\Omega \\neq \\emptyset \\text{ y } \\{e_+,e_-\\} \\cap E\\setminus \\Omega \\neq \\emptyset\\} \\] es decir las aristas que conectan \\(\\Omega\\) con su complemento en cualquier orientación. La cantidad \\(i(e)n_\\Omega(e)\\) es positiva cuando \\(e_-\\in \\Omega\\), \\(e_+\\in V\\setminus \\Omega\\) y \\(i(e)&gt;0\\); o bien cuando \\(e_-\\in V\\setminus \\Omega\\), \\(e_+\\in \\Omega\\) y \\(i(e)&lt;0\\). En cualquier caso, \\(i(e)n_\\Omega(e)\\) se interpreta como la cantidad de masa que escapa de \\(\\Omega\\) por medio de \\(e\\). Un razonamiento similar se dá cuando \\(i(e)n_\\Omega(e)\\) es negativo para la masa que entra. El balance total nos dice que la masa que se produce o absorbe en \\(\\Omega\\) se puede medir de dos formas, sumando las divergencias en \\(\\Omega\\) u observando las contribuciones que escapan o entran por las aristas que conectan a \\(\\Omega\\) con su complemento \\(V\\setminus \\Omega\\) en cualquier orientación. Demostración. Sean \\(1_\\pm:V\\times E\\to \\mathbb R\\) definidas según \\[ 1_\\pm(v,e) := \\begin{cases} 1 \\text{ si } e_\\pm = v,\\\\ 0 \\text{ en cualquier otro caso}. \\end{cases} \\] En particular usaremos que \\[ \\sum_{v\\in \\Omega} 1_\\pm(v,e) = \\begin{cases} 1 \\text{ si } e_\\pm \\in \\Omega,\\\\ 0 \\text{ encualquier otro caso} \\end{cases} \\] Tenemos así que \\[ \\begin{aligned} \\sum_{v\\in \\Omega} \\operatorname{div} i(v) &amp;= \\sum_{v\\in \\Omega} \\sum_{e_-=v} i(e) - \\sum_{v\\in \\Omega} \\sum_{e_+=v} i(e),\\\\ &amp;= \\sum_{v\\in \\Omega} \\sum_{e \\in E} i(e)1_-(v,e) - \\sum_{v\\in \\Omega} \\sum_{e \\in E} i(e)1_-(v,e),\\\\ &amp;= \\sum_{e \\in E} \\sum_{v\\in \\Omega}i(e)1_-(v,e) - \\sum_{e \\in E} \\sum_{v\\in \\Omega}i(e)1_-(v,e),\\\\ &amp;= \\sum_{e_-\\in \\Omega} i(e) -\\sum_{e_+\\in \\Omega} i(e),\\\\ &amp;= \\sum_{\\substack{e_-\\in \\Omega\\\\e_+\\in V\\setminus \\Omega}} i(e) + \\sum_{e_-, e_+\\in \\Omega} i(e) - \\sum_{\\substack{e_+\\in \\Omega\\\\e_-\\in V\\setminus \\Omega}} i(e) - \\sum_{e_-, e_+\\in \\Omega} i(e),\\\\ &amp;= \\sum_{\\substack{e_-\\in \\Omega\\\\e_+\\in V\\setminus \\Omega}} i(e) - \\sum_{\\substack{e_+\\in \\Omega\\\\e_-\\in V\\setminus \\Omega}} i(e) \\end{aligned} \\] Esta última expresión es por definición de \\(n_\\Omega\\) igual a \\[ \\sum_{e\\in E} i(e)n_\\Omega(e), \\] con lo cual se concluye la demostración. Margen de cálculo: El teorema de la divergencia El teorema de la divergencia nos dice que dado un subconjunto \\(\\Omega \\subset\\mathbb R^n\\) con frontera localmente de clase \\(C^1\\) a trozos, y campo \\(v\\in C^1(\\overline{\\Omega}\\to\\mathbb R^n)\\), entonces \\[ \\int_\\Omega \\operatorname{div} v = \\int_{\\partial \\Omega} v\\cdot n \\] donde \\(n\\) es el vector normal exterior a \\(\\Omega\\). El lado derecho integra el flujo que escapa o entra en \\(\\Omega\\) a través de su borde. En concreto, si en un punto dado del borde \\(v\\cdot n &gt;0\\) entonces \\(v\\) apunta en la dirección de \\(n\\) y el flujo escapa con una tasa igual a \\(v\\cdot n\\), si en cambio \\(v\\cdot n &lt; 0\\) el flujo estaría entrando, y si \\(v\\cdot n=0\\) se tiene que \\(v\\) es tangente y el flujo apenas roza la superficie. El lado izquierdo de la expresión es una integral sobre \\(\\Omega\\) que representa la producción/absorción de flujo por el campo \\(v\\). 3.2.2 Lema de Poincaré para la divergencia Teorema 3.3 Sea \\(G=(V,E)\\) un grafo dirigido finito. Para cualquier \\(\\mu:V\\to\\mathbb R\\) tal que \\[ \\sum_{x\\in V}\\mu(x)=0 \\] existe por lo menos una solución \\(i:E\\to\\mathbb R\\) de \\[ \\operatorname{div} i = \\mu. \\] Demostración. Asumamos sin pérdida de generalidad que \\(G\\) es conexo. Tomemos un nodo arbitrario \\(x_0\\in V\\) y consideremos inductivamente caminos no orientados que vayan conectando a \\(x_0\\) con cada uno de los nodos restantes y de tal forma que nunca se formen ciclos en esta construcción. Es decir, estamos proponiendo un árbol generador del grafo con raíz en el nodo \\(x_0\\), es decir un sub-grafo de \\(G\\) libre de ciclos que conecta a todos los vértices. Fijamos \\(i=0\\) en las aristas que no pertenecen a los caminos señalados y en los demás ajustaremos \\(i\\) para que satisfaga la ecuación dada. La idea ahora consiste en ir tomando distintas ramas del árbol e ir asignando \\(i\\) convenientemente como una función impar. Sea por ejemplo \\(y_1,\\ldots,y_k\\) una rama, donde \\(y_1\\) es una hoja, es decir un nodo del árbol con un único nodo adyacente en el árbol (\\(y_2\\)). Tomemos \\(e_j = (y_j,y_{j+1})\\) y vamos fijando \\(i\\) recursivamente tal que \\[ i(e_{j+1}) = i(e_j) + \\mu(y_{j+1}), \\qquad i(e_1) = \\mu(y_1). \\] Esto garantiza que \\(\\operatorname{div} i=\\mu\\) sobre \\(y_1,\\ldots,y_{k-1}\\). Una vez terminado este algoritmo garantizamos que \\(\\operatorname{div} i=\\mu\\) en \\(V\\setminus \\{x_0\\}\\). Como último paso debe también cumplirse la ecuación en \\(x_0\\) gracias a que \\(\\sum_{x\\in V} \\operatorname{div} i(x)=\\sum_{x\\in V} \\mu(x)=0\\). Notemos que si \\(x_0,\\ldots,x_k=x_0\\) es un dado ciclo del grafo, entonces si tomamos \\(i=1\\) en las aristas del ciclo y cero por fuera de estas, obtenemos una solución de \\(\\operatorname{div} i=0\\). De hecho, todas las soluciones homogéneas se obtienen por superposiciones de este ejemplo. El núcleo de la divergencia es un espacio vectorial generado por los ciclos independientes del grafo y su dimensión es un imprtante invariante topológico conocido como el primer número de Betti. Ejercicio 3.5 Calcula los flujos \\(i:E\\to \\mathbb R\\) tal que \\(\\operatorname{div} i=\\mu\\) Solución Verificamos primero que la suma de los valores en los nodos se anula. Para calcular una solución particular tomamos el árbol generador con aristas \\(a\\), \\(b\\), \\(-e\\) y definimos así \\[ i(c)=i(d)=0, \\qquad i(a)=1, \\qquad i(e)=2, \\qquad i(b)=0 \\] el cual verifica fácilmente la ecuación de divergencia esperada. Cualquier otra solución se obtiene como la superposición de la solución previa con las del sistema homogéneo \\[ \\begin{cases} i(a)+i(b)-i(e)=0,\\\\ -i(a)+i(c)=0,\\\\ -i(b)+i(d)=0,\\\\ -i(c)-i(d)+i(e)=0. \\end{cases} \\] Dos soluciones linealmente independientes se obtienen por ejemplo de los ciclos \\(a,c,e\\) y \\(b,d,e\\) respectivamente \\[ \\begin{aligned} &amp;i(a)=i(c)=i(e)=1,\\qquad i(b)=i(d)=0,\\\\ &amp;i(a)=i(c)=0, \\qquad i(b)=i(d)=i(e)=1. \\end{aligned} \\] Si usamos la reducción de Gauss-Jordan podemos verificar que esta es además una base de las soluciones homogéneas. 3.3 Integración por partes En esta sección denotamos \\(M=|V|&lt;\\infty\\) e identificamos a las funciones \\(u:V\\to \\mathbb R\\) con vectores de \\(\\mathbb R^M\\). Igualmente, \\(N=|E|&lt;\\infty\\) e identificamos a las funciones \\(i:E\\to \\mathbb R\\) con vectores de \\(\\mathbb R^N\\). Eventualmente también podríamos considerar funciones complejas. El gradiente \\(D:\\mathbb R^M\\to\\mathbb R^N\\) se representa así por la matriz \\((D_{e,x}) \\in \\mathbb R^{N\\times M}\\) tal que \\[ D_{e,x} = \\begin{cases} 1 \\text{ si } x=e_+,\\\\ -1 \\text{ si } x=e_-,\\\\ 0 \\text{ en cualquier otro caso}. \\end{cases} \\] Mientras que la divergencia \\(\\operatorname{div}:\\mathbb R^N\\to\\mathbb R^M\\) se representa por la matriz \\((\\operatorname{div}_{x,e}) \\in \\mathbb R^{M\\times N}\\) tal que \\[ \\operatorname{div}_{x,e} = \\begin{cases} -1 \\text{ si } e_+=x,\\\\ 1 \\text{ si } e_-=x,\\\\ 0 \\text{ en cualquier otro caso}. \\end{cases} \\] Descubrimos de esta forma que \\(D^T = -\\operatorname{div}\\) o equivalentemente la fórmula de integración por partes \\[ \\sum_{e\\in E} (iDu)(e) = i\\cdot Du = -u\\cdot \\operatorname{div} i = -\\sum_{x\\in V} (u\\operatorname{div} i)(x). \\] Ejercicio 3.6 Calcula las matrices asociadas con el gradiente y la divergencia para el siguiente grafo Solución \\[ D = \\begin{pmatrix} -1 &amp; 1 &amp; 0 &amp; 0\\\\ 0 &amp; -1 &amp; 1 &amp; 0\\\\ 1 &amp; 0 &amp; -1 &amp; 0\\\\ -1 &amp; 0 &amp; 0 &amp; 1\\\\ 0 &amp; 0 &amp; 1 &amp; -1 \\end{pmatrix} \\qquad \\operatorname{div} = -D^T = \\begin{pmatrix} 1 &amp; 0 &amp; -1 &amp; 1 &amp; 0\\\\ -1 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; -1 &amp; 1 &amp; 0 &amp; -1\\\\ 0 &amp; 0 &amp; 0 &amp; -1 &amp; 1 \\end{pmatrix}. \\] Ejercicio 3.7 Demuestra la fórmula de integración por partes sobre un dominio \\(\\Omega \\subseteq V\\) \\[\\begin{equation} \\sum_{\\Omega} u\\operatorname{div}i = \\sum_{E} u^-in_\\Omega - \\sum_{e_+\\in \\Omega} iDu \\tag{3.1} \\end{equation}\\] Solución Basta con usar que \\(Dv\\cdot i = - v\\cdot \\operatorname{div} i\\) para \\(v := u 1_{\\Omega}\\). Margen de cálculo: Integración por partes La fórmula de integración por partes nos dice que dado un subconjunto \\(\\Omega \\subset\\mathbb R^n\\) con frontera localmente de clase \\(C^1\\) a trozos, un campo vectorial \\(v\\in C^1(\\overline{\\Omega}\\to\\mathbb R^n)\\), y un campo escalar \\(u\\in C^1(\\overline{\\Omega}\\to\\mathbb R^n)\\) entonces \\[ \\int_\\Omega u \\operatorname{div} v = \\int_{\\partial \\Omega} u v\\cdot n - \\int_\\Omega Du\\cdot v \\] donde \\(n\\) es el vector normal exterior a \\(\\Omega\\). 3.3.1 Descomposición de Helmholtz Al igual que antes sean \\(M=|V|\\) y \\(N=|E|\\). La relación \\(D^T=-\\operatorname{div}\\) nos permite dar la descomposición ortogonal \\[ \\mathbb R^N = D(\\mathbb R^M) + \\ker(\\operatorname{div}). \\] también conocida como la descomposición de Helmholtz. Es decir que cualquier \\(i:E\\to\\mathbb R\\) puede escribirse de forma única3 como \\[ i= Du + j \\] tal que \\[ \\operatorname{div} j = 0, \\] y como corolario \\(Du \\perp j\\). En términos físicos, cualquier flujo se descompone en una parte que preserva la masa (\\(j\\)) y en un flujo gradiente (\\(Du\\)). Margen de álgebra lineal: El teorema fundamental de álgebra lineal Dado \\(A:\\mathbb R^M\\to \\mathbb R^N\\) se tiene que \\[ A(\\mathbb R^M)^\\perp = \\ker(A^T). \\] Si \\(x \\perp A(\\mathbb R^M)\\) entonces \\(0 = x\\cdot AA^Tx = \\|A^T x\\|^2\\), lo cual implica \\(A^Tx=0\\). Por otro lado si \\(A^Tx=0\\) entonces para \\(y\\in \\mathbb R^M\\) arbitrario \\(x\\cdot Ay = A^Tx\\cdot y=0\\). Ejercicio 3.8 Calcula la descomposición de Helmholtz para el siguiente flujo Solución Sea \\(i:E\\to \\mathbb R\\) los valores que se muestran en la gráfica. Buscamos calcular \\(u:V\\to \\mathbb R\\) y \\(j:E\\to \\mathbb R\\) tales que \\(i=Du+j\\) y \\(\\operatorname{div}j=0\\). Si tomamos así la divergencia en la expresión \\(i=Du+j\\) encontramos que \\(u\\) satisface \\[ \\begin{cases} -2u(A)+u(B)+u(C)=3,\\\\ u(A)-3u(B)+u(C)+u(D)=4,\\\\ u(A)+u(B)-3u(C)+u(D)=-7,\\\\ u(B)+u(C)-2u(D)=0. \\end{cases} \\] Las soluciones homogénes del sistema son los potenciales constantes4. Ajustando esta constante de forma que \\(u(A)=0\\) obtenemos un sistema que podemos resolver numéricamente import numpy as np A = np.array([[ 1, 1, 0], [-3, 1, 1], [ 1,-3, 1]]) B = np.array([3, 4, -7]) X = np.linalg.inv(A).dot(B) Du = [X[0],X[1]-X[0],-X[1],X[2]-X[1],X[0]-X[2]] i= np.array([1,5,-2,0,0]) j = i-Du print(&quot;[Du(AB), Du(BC), Du(CA), Du(CD), Du(DB)] = {}.&quot;.format(Du)) ## [Du(AB), Du(BC), Du(CA), Du(CD), Du(DB)] = [0.125, 2.75, -2.875, -1.375, -1.375]. print(&quot;[j(AB), j(BC), j(CA), j(CD), j(DB)] = {}.&quot;.format(j)) ## [j(AB), j(BC), j(CA), j(CD), j(DB)] = [0.875 2.25 0.875 1.375 1.375]. 3.4 Laplaciano El Laplaciano es un operador diferencial que se construye aplicando sucesivamente el gradiente y la divergencia. Es decir que mide la producción de masa del gradiente. Además, luego de una manipulación algebraica, observamos que es proporcional a la diferencia entre el promedio en los vértices adyacentes y el valor en el centro. Definición 3.6 Dado \\(u: V \\to \\mathbb R\\), el Laplaciano \\(\\Delta u: V \\to \\mathbb R\\) se define tal que \\[ \\Delta u(v) = \\operatorname{div}(D u)(v) = \\sum_{w \\sim v} (u(w)-u(v)). \\] donde \\(w \\sim v\\) si existe una arista que une a \\(v\\) y \\(w\\) en cualquier orientación. A pesar de que tanto el gradiente como la divergencia requieren que el grafo tenga una orientación, el Laplaciano está bien definido en grafos no dirigidos. Cuando \\(u: V \\to \\mathbb R\\) es un potencial tal que \\(\\Delta u=0\\) en \\(\\Omega \\subseteq V\\), decimos que \\(u\\) es una función armónica sobre \\(\\Omega\\). Ejemplo 3.7 Considera una red eléctrica con resistencias de un Ohm (\\(R(e)=1\\)) la cual modelamos como una grafo dirigido de forma arbitraria. Una batería de un voltio entre dos nodos \\(v_+,v_-\\in V\\) genera un potencial eléctrico \\(u:V\\to \\mathbb R\\) que se puede determinar a partir de la ley de Ohm y la ley de Kirchhoff. Según la ley de Ohm tenemos que la corriente se calcula según \\[ i=Du. \\] Según la ley de Kirchhoff tenemos que fuera de los nodos donde se conecta la bateria, la corriente se conserva, es decir \\[ 0=\\operatorname{div}i = \\Delta u \\text{ en } V\\setminus\\{v_\\pm\\} \\] Junto con las condiciones de borde en los nodos donde se conecta la batería \\[ \\qquad u(v_+) = 1, \\qquad u(v_-) = 0, \\] obtenemos un sistme de ecuaciones lineales con igual número de ecuaciones que de incógnitas. Ejercicio 3.9 Calcula el potencial eléctrico que se genera en un cubo de resistencias de un Ohm, cuando se conecta una batería de un voltio entre dos nodos opuestos del cubo Solución Asumamos sin pérdida de gneralidad que se conecta la bateria de los nodos \\(A\\) a \\(D\\) tal que \\(v(A)=1\\) y \\(v(D)=0\\). Tenemos un sistema de ecuaciones lineales de dimensiones 6 por 6. De existir una única solución5 observamos que por simetría se debe cumplir que \\(v(B)=v(F)=v(H)=\\alpha\\) (los nodos adyacentes a \\(A\\)) y \\(v(C)=v(E)=v(G)=\\beta\\) (los nodos adyacentes a \\(E\\)). Esto reduce el sistema a uno de 2 por 2 \\[ \\begin{cases} -9\\alpha+6\\beta = -3,\\\\ 6\\alpha -9\\beta = 0 \\end{cases} \\qquad\\Rightarrow\\qquad \\alpha = \\frac{3}{5}, \\qquad \\beta = \\frac{2}{5}. \\] Ejercicio 3.10 Da un análogo discreto para la fórmula de Green \\[ \\int_\\Omega (u_1\\Delta u_2 - u_2\\Delta u_1) = \\int_{\\partial\\Omega} (u_1Du_2 - u_2 Du_1)\\cdot n \\] Solución De la fórmula de integración por partes (3.1) \\[ \\sum_\\Omega u_i \\Delta u_j = \\sum_{E} u_i^- Du_j n_\\Omega - \\sum_{e_+\\in \\Omega} Du_iDu_j \\] Por lo tanto al tomar la resta se cancelan el segundo término a la deracha quedando así \\[ \\sum_\\Omega (u_1 \\Delta u_2-u_2 \\Delta u_1) = \\sum_{E} (u_1^- Du_2 - u_2^- Du_1)n_\\Omega. \\] En general podemos añadir una operación intermedia entre el gradiente y la divergencia. Esto genera operadores con características similares al Laplaciano. Ejemplo 3.8 Considera ahora una red eléctrica con resistencias variables. La ley de Ohm consiste en tomar el gradiente del potencial y luego dividir por las resistencias para obtener la corriente. Al recíproco de la resistencia también se le conoce como la capacitancia y puede ser más conveniente de usar en este ejemplo. En este caso las ecuaciones de balance para el potencial eléctrico tienen la forma \\[ \\operatorname{div} (CDu) = 0 \\qquad C = 1/R : \\text{Capacitancia} \\] (fuera de los nodos donde se conecta la batería). Ejemplo 3.9 Las ecuaciones de balance en los entramados se implementan en tres pasos: Se toman las posiciones relativas entre nodos adyacentes, es decir el gradiente de las posiciones \\(q:V\\to\\mathbb R^2\\). Se forman las tensiones a partir de las posiciones relativas y los multiplicadores \\(\\lambda:E\\to \\mathbb R\\). Se propone el balance de fuerzas en términos de la divergencia de la tensión. En síntesis se obtiene que en los nodos libres \\[ \\operatorname{div} (\\lambda D q) = mge_2 \\] A diferencia de los problemas de redes eléctricas, tanto \\(q\\) como \\(\\lambda\\) son variables por ser determinadas lo cual hace que el problema sea no-lineal en dichas incógnitas. es decir que cualquier ciclo puede ser deformado continuamente a un punto. Por ejemplo, si \\(n=2\\) dice que \\(\\Omega\\) no tiene hoyos.↩︎ Dado \\(i:E\\to \\mathbb R\\), el potencial \\(u\\) no es único pero su gradiente \\(Du\\) sí.↩︎ Esto puede verificarse de la reducción de Gauss-Jordan en este caso, y además será demostrado con mayor generalidad.↩︎ Una vez más, esto puede chequearse a mano o con una herramienta numérica.↩︎ "],["cross.html", "Capítulo 4 Cross-references 4.1 Chapters and sub-chapters 4.2 Captioned figures and tables", " Capítulo 4 Cross-references Cross-references make it easier for your readers to find and link to elements in your book. 4.1 Chapters and sub-chapters There are two steps to cross-reference any heading: Label the heading: # Hello world {#nice-label}. Leave the label off if you like the automated heading generated based on your heading title: for example, # Hello world = # Hello world {#hello-world}. To label an un-numbered heading, use: # Hello world {-#nice-label} or {# Hello world .unnumbered}. Next, reference the labeled heading anywhere in the text using \\@ref(nice-label); for example, please see Chapter 4. If you prefer text as the link instead of a numbered reference use: any text you want can go here. 4.2 Captioned figures and tables Figures and tables with captions can also be cross-referenced from elsewhere in your book using \\@ref(fig:chunk-label) and \\@ref(tab:chunk-label), respectively. See Figure 4.1. par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figura 4.1: Here is a nice figure! Don’t miss Table 4.1. knitr::kable( head(pressure, 10), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Tabla 4.1: Here is a nice table! temperature pressure 0 0.0002 20 0.0012 40 0.0060 60 0.0300 80 0.0900 100 0.2700 120 0.7500 140 1.8500 160 4.2000 180 8.8000 "],["dinámica.html", "Capítulo 5 Dinámica 5.1 Difusión 5.2 Oscilación", " Capítulo 5 Dinámica 5.1 Difusión Consideremos un grafo dirigido \\(G=(V,E)\\) y una familia de densidades \\(u(x,t)\\) que toma valores reales para cada vértice \\(x\\in V\\) en tiempo \\(t\\in\\mathbb R\\). Decimos que un flujo \\(f(e,t)\\) transporta a \\(u\\) si en cada instante salen \\(f(e,t)\\) unidades de masa de \\(e_-\\) hacia \\(e_+\\) por la arista \\(e\\). Es decir que sobre cada \\(x\\in V\\) se tiene que \\[ \\partial_t u(x,t) = \\sum_{e_+=x} f(e,t) - \\sum_{e_-=x} f(e,t) = -\\operatorname{div} f(x,t). \\] En distintos modelos puede darse el caso de que \\(f\\) esté determinada por la misma función \\(u\\), esto se conoce como una ley constitutiva. Un caso muy común es que \\(f\\) sea proporcional a \\(-Du\\). Ejemplo 5.1 Sea \\(G=(V,E)\\) un grafo que modela una red de habitaciones en renta y \\(u:V\\times \\mathbb R\\to\\mathbb R\\) la población que vive en dicha red. Asumiendo la ley de oferta y demanda, el precio de renta \\(p=p(x,t)\\) de una habitación \\(x\\) en el instante \\(t\\) debe ser proporcional a la demanda, la cual podemos considerar en nuestro caso proporcional a la población que habita dicho nodo, digamos por ejemplo que \\(p = k_1u\\). La población busca moverse entre nodos adyacentes si percibe que el precio le es favorable, por ejemplo \\(f=-k_2Dp\\). Llegamos así a la ecuación \\[ \\partial_t u = -\\operatorname{div} f = \\operatorname{div}(k_2Dp) = \\operatorname{div}(aDu), \\qquad a := k_1k_2. \\] Ejercicio 5.1 Demuestra que el total de la población se mantiene constante. Solución Gracias a la fórmula de divergencia \\[ \\partial_t \\sum_{V} u = \\sum_{V} \\partial_t u = \\sum_{V} \\operatorname{div}(aDu)=0. \\] El problema \\(\\partial_t u = \\operatorname{div}(aDu)\\), también conocido como la ecuación de calor o difusión, representa un sistema de EDOs lineales y de primer orden con tantas ecuaciones e incógnitas como la cardinalidad de \\(V\\). Ejemplo 5.2 Las funciones \\(S\\) e \\(I\\) representan poblaciones de individuos susceptibles e infectados para una dada epidemia modelada geográficamente sobre un grafo. Cada una de ellas se mueve sobre una red por flujos dados por \\[ f_S = -c_S DS, \\qquad f_I = -c_I DI. \\] La dinámica de la epidemia en cada nodo está dada por las tazas de transmisión (\\(\\beta\\)) y recuperación (\\(\\gamma\\)). En específico planteamos el modelo de \\(2|V|\\) ecuaciones de primer orden no-lineales \\[ \\partial_t S = -\\beta SI + \\operatorname{div}(c_SDS), \\qquad \\partial_t I = \\beta SI - \\gamma I + \\operatorname{div}(c_IDI) \\] Ejercicio 5.2 Demuestra que el total de la población susceptible o infectada es una función decreciente. Solución \\[ \\partial_t \\sum_{V} (S+I) = \\sum_{V} (-\\gamma I + \\operatorname{div}(c_SDS)+\\operatorname{div}(c_IDI)) = - \\gamma \\sum_{V} I \\leq 0. \\] 5.2 Oscilación El sistema de EDOs lineales y de segundo orden dado por \\[ \\partial_t^2 u = \\operatorname{div}(aDu) \\] también es común en distintos modelos. Esta se conoce como la ecuación de onda. Ejemplo 5.3 Un grafo \\(G=(V,E)\\) modela las conexiones en un sistema de masas \\(m:V\\to (0,\\infty)\\) unidas por resortes con constantes \\(k:E\\to[0,\\infty)\\). Sea \\(q:V\\to \\mathbb R^n\\) los desplazamientos de las masas a partir de una configuración dada de equilibrio. A partir de la ley de Hooke planteamos el sistema \\(n\\times|V|\\) ecuaciones e incógnitas, \\[ m\\partial_t^2 q = \\operatorname{div}(kDq). \\] Recordemos que cualquier sistema de segundo orden puede ser llevado a un sistema de primer orden tomando a las velocidades como incógnitas del sistema. Por ejemplo, \\[ \\partial_t^2 u = \\operatorname{div}(aDu) \\qquad \\Leftrightarrow\\qquad \\begin{cases} \\partial_t u = v,\\\\ \\partial_t v = \\operatorname{div}(aDu). \\end{cases} \\] Ejemplo 5.4 El grafo \\(G=(V,E)\\) vuelve a modelar una red de habitaciones en renta, \\(u:V\\times \\mathbb R\\to\\mathbb R\\) la población que vive en dicha red y \\(p:V\\times \\mathbb R\\to\\mathbb R\\) los precios. Una vez más asumimos que la población se mueve según el flujo \\(f = -Dp\\). Por otro lado los precios se modifican gradualmente dependiendo de la demanda en relación a los nodos adyacentes. Esto último puede ser reflejado por ejemplo en la ecuación \\(\\partial_t p = -\\Delta u\\), es decir que el precio disminuye si el promedio de la población vecina es mayor la población en el nodo en consideración, con la intención de atraerla. En resumen obtenemos el sistema de ecuaciones \\[ \\partial_t u = \\Delta p, \\qquad \\partial_t p = -\\Delta u. \\] Estas implican las ecuaciones de onda desacopladas para el bilaplaciano \\[ \\partial_t^2 u = -\\Delta^2 u, \\qquad \\partial_t^2 p = -\\Delta^2p. \\] "],["parts.html", "Capítulo 6 Parts", " Capítulo 6 Parts You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file. Add a numbered part: # (PART) Act one {-} (followed by # A chapter) Add an unnumbered part: # (PART\\*) Act one {-} (followed by # A chapter) Add an appendix as a special kind of un-numbered part: # (APPENDIX) Other stuff {-} (followed by # A chapter). Chapters in an appendix are prepended with letters instead of numbers. "],["footnotes-and-citations.html", "Capítulo 7 Footnotes and citations 7.1 Footnotes 7.2 Citations", " Capítulo 7 Footnotes and citations 7.1 Footnotes Footnotes are put inside the square brackets after a caret ^[]. Like this one 6. 7.2 Citations Reference items in your bibliography file(s) using @key. For example, we are using the bookdown package (Xie 2022) (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and knitr (Xie 2015) (this citation was added manually in an external file book.bib). Note that the .bib files need to be listed in the index.Rmd with the YAML bibliography key. The RStudio Visual Markdown Editor can also make it easier to insert citations: https://rstudio.github.io/visual-markdown-editing/#/citations References "],["blocks.html", "Capítulo 8 Blocks 8.1 Equations 8.2 Theorems and proofs 8.3 Callout blocks", " Capítulo 8 Blocks 8.1 Equations Here is an equation. \\[\\begin{equation} f\\left(k\\right) = \\binom{n}{k} p^k\\left(1-p\\right)^{n-k} \\tag{8.1} \\end{equation}\\] You may refer to using \\@ref(eq:binom), like see Equation (8.1). 8.2 Theorems and proofs Labeled theorems can be referenced in text using \\@ref(thm:tri), for example, check out this smart theorem 8.1. Teorema 8.1 For a right triangle, if \\(c\\) denotes the length of the hypotenuse and \\(a\\) and \\(b\\) denote the lengths of the other two sides, we have \\[a^2 + b^2 = c^2\\] Read more here https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html. 8.3 Callout blocks The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html "],["sharing-your-book.html", "Capítulo 9 Sharing your book 9.1 Publishing 9.2 404 pages 9.3 Metadata for sharing", " Capítulo 9 Sharing your book 9.1 Publishing HTML books can be published online, see: https://bookdown.org/yihui/bookdown/publishing.html 9.2 404 pages By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If you’d like to customize your 404 page instead of using the default, you may add either a _404.Rmd or _404.md file to your project root and use code and/or Markdown syntax. 9.3 Metadata for sharing Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the index.Rmd YAML. To setup, set the url for your book and the path to your cover-image file. Your book’s title and description are also used. This gitbook uses the same social sharing data across all chapters in your book- all links shared will look the same. Specify your book’s source repository on GitHub using the edit key under the configuration options in the _output.yml file, which allows users to suggest an edit by linking to a chapter’s source file. Read more about the features of this output format here: https://pkgs.rstudio.com/bookdown/reference/gitbook.html Or use: ?bookdown::gitbook "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
